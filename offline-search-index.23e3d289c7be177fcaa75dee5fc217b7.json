

















































































































































































































































































[{"body":"","categories":["Ubuntu","筆記","文件"],"description":"","excerpt":"","ref":"/docs/","tags":["Ubuntu","筆記","文件"],"title":"教學文件"},{"body":"建立 ssh key ssh-keygen -t rsa -b 4096 -C \"kj@example.com\" 變更 ssh port 開啟設定檔案\nsudo vim /etc/ssh/sshd_config 找尋 Port 並變更\n# What ports, IPs and protocols we listen for Port 22 重新啟動 ssh 服務即可\nsudo service ssh restart 是否允許密碼登入 # /etc/ssh/sshd_config # Change to no to disable tunnelled clear text passwords PasswordAuthentication yes 僅允許使用 key 登入 為了安全性，避免主機被使用帳號密碼 try，可以僅使用 key 登入，將密碼 ssh 登入方式關閉\n# /etc/ssh/sshd_config PasswordAuthentication no RSAAuthentication yes PubkeyAuthentication yes AuthorizedKeysFile %h/.ssh/authorized_keys 在自己電腦產生 key\nssh-keygen -t rsa -b 4096 -C \"kj@kejyun.com\"  id_rsa.pub：公開金鑰（public key），放在 Ubuntu 主機 id_rsa：私密金鑰（private key），不可外洩的個人金鑰  將 id_rsa.pub 公開金鑰放在 ~/.ssh/authorized_keys*\n~$ mkdir .ssh ~$ cd .ssh ~/.ssh$ vim authorized_keys 重新啟動 ssh 服務\nservice ssh restart 使用 key 登入\nssh -p \u003cssh_port\u003e -i /Users/kejyun/.ssh/id_rsa -l \u003caccount\u003e \u003cip_address\u003e ssh -p 22 -i /Users/kejyun/.ssh/id_rsa -l kj 127.0.0.1 SSH Log SSH Log 檔案放在 /var/log/auth.log\ngrep 'sshd' /var/log/auth.log tail -f /var/log/auth.log Authentication refused: bad ownership or modes for directory ssh 登入為了安全性，對於 .ssh 目錄的讀寫權限有限制，需要為 775 或 700\nid_rsa.pub 與 authorized_keys 權限為 644\nid_rsa 權限為 600\n指定 key 及帳號 在做 ssh 連線 alias 指令時，想要直接接著需要連線的 IP，那麼就必須要把參數先指定好，後面才可以直接接著 IP\nssh -p \u003cport\u003e -i \u003cssh_key_path\u003e -l \u003caccount\u003e  -p：port -i：ssh 金鑰路徑 -l：帳號名稱  ssh -p 22 -i ~/.ssh/id_rsa -l kejyun 使用 shell function 做 ssh 登入\nf() { ssh \u003caccount\u003e@$1 -i \"\u003cssh_key_path\u003e\"; }; f f() { ssh kejyun@$1 -i \"~/.ssh/id_rsa\"; }; f 在本機透過 ssh tunnel 直接連線主機 ssh -t -p \u003cport\u003e -l \u003caccount\u003e \u003cssh_tunnel_server\u003e bash -ic 'ssh_internal_server \u003cip_address\u003e' ssh -t -p 22 -l kejyun server.kj.com bash -ic 'ssh_kj 1.1.1.1' 參考資料  Generating a new SSH key and adding it to the ssh-agent - User Documentation ssh - How to check sshd log? - Server Fault ssh免密码登陆设置时Authentication refused: bad ownership or modes错误解决方法 - 博学无忧 openssl - ssh-keygen does not create RSA private key - Server Fault  ","categories":["Ubuntu","筆記","文件","常用網路指令","網路","Network","ssh","建立金鑰"],"description":"Ubuntu 系統網路 ssh 建立金鑰指令","excerpt":"Ubuntu 系統網路 ssh 建立金鑰指令","ref":"/docs/network/ssh/create-ssh-key/","tags":["Ubuntu","筆記","文件","常用網路指令","網路","Network","ssh","建立金鑰"],"title":"建立金鑰"},{"body":"","categories":["Ubuntu","筆記","文件","常用網路指令","網路","Network","ssh"],"description":"Ubuntu 系統網路 ssh 指令","excerpt":"Ubuntu 系統網路 ssh 指令","ref":"/docs/network/ssh/","tags":["Ubuntu","筆記","文件","常用網路指令","網路","Network","ssh"],"title":"ssh"},{"body":"測試設定檔 apachectl configtest 啟動關閉 Apache 服務 sudo service apache2 stop sudo service apache2 start sudo service apache2 restart 關閉 Apache 避免開機執行 Apache # 關閉 sudo update-rc.d -f apache2 remove # 恢復自動啟動 sudo update-rc.d apache2 defaults sudo update-rc.d apache2 disable sudo update-rc.d apache2 enable 移除 Apache sudo apt-get purge -y apache2* 參考資料  How to disable apache2 server from auto starting on boot - Ask Ubuntu Microsoft Word - Installing_and_working_with_ Apache_web server uninstall - How Can I stop Apache2 on Ubuntu 18.04? - Ask Ubuntu  ","categories":["Ubuntu","筆記","文件","網站","Web Software","Build website","Apache"],"description":"Ubuntu Apache 建置常用指令","excerpt":"Ubuntu Apache 建置常用指令","ref":"/docs/web/apache/","tags":["Ubuntu","筆記","文件","網站","Web Software","Build website","Apache"],"title":"Apache"},{"body":"計算行數 加入 -c 參數即可顯示行數\ncat * | grep -c 參考資料\n Count all occurrences of a string in lots of files with grep - Stack Overflow  搜尋目錄下指定字串 grep -r \"[STRING TO SEARCH FOR]\" \"[DIRECTORY TO SEARCH]\" grep -r \"search text\" \"/tmp/search/folder\" 參考資料  command line - how to find a word in text files from a directory - Ask Ubuntu  ","categories":["Ubuntu","筆記","文件","grep 指令","grep"],"description":"Ubuntu 系統 grep 指令","excerpt":"Ubuntu 系統 grep 指令","ref":"/docs/command/grep/","tags":["Ubuntu","筆記","文件","grep 指令","grep"],"title":"grep"},{"body":"Let’s Encrypt 安裝 $ sudo add-apt-repository ppa:certbot/certbot $ sudo apt-get update Nginx\n$ sudo apt-get install python-certbot-nginx Apache\n$ sudo apt-get install python-certbot-apache 執行憑證驗證 $ sudo certbot 自動更新憑證 更新憑證\nsudo certbot renew 測試更新憑證\nsudo certbot renew --dry-run Crontab 自動更新\n需要輸入完整執行檔案名稱，然後指定需要自動更新時間\n30 2 * * 1 certbot renew /etc/ssl/certs/dhparam.pem 在安裝 SSL 憑證時，會出現下列訊息時，可以使用 openssl 去新增 dhparam.pem 憑證\nnginx: [emerg] BIO_new_file(\"/etc/ssl/certs/dhparam.pem\") failed (SSL: error:02001002:system library:fopen:No such file or directory:fopen('/etc/ssl/certs/dhparam.pem','r') error:2006D080:BIO routines:BIO_new_file:no such file) 使用下列指令可以新增 dhparam.pem 憑證\nsudo openssl dhparam -out /etc/ssl/certs/dhparam.pem 2048 移除指定憑證 如果不需要 SSL 憑證了，可以使用下列指令將網域移除\nsudo certbot delete --cert-name kejyun.com 解決 certbot-auto 版本過舊問題 在使用舊版 certbot-auto 安裝憑證時，因為 certbot-auto 會自動更新自己的版本，導致發生 python 版本過舊導致無法驗證憑證\nInstalling Python packages... /opt/eff.org/certbot/venv/bin/python: No module named pip.__main__; 'pip' is a package and cannot be directly executed Traceback (most recent call last): File \"/tmp/tmp.OGGbtieawI/pipstrap.py\", line 177, in \u003cmodule\u003e sys.exit(main()) File \"/tmp/tmp.OGGbtieawI/pipstrap.py\", line 149, in main pip_version = StrictVersion(check_output([python, '-m', 'pip', '--version']) File \"/usr/lib/python2.7/subprocess.py\", line 544, in check_output raise CalledProcessError(retcode, cmd, output=output) subprocess.CalledProcessError: Command '['/opt/eff.org/certbot/venv/bin/python', '-m', 'pip', '--version']' returned non-zero exit status 1 可以使用 --no-self-upgrade 參數，讓 certbot-auto 不要自動更新版本\nwget https://raw.githubusercontent.com/certbot/certbot/75499277be6699fd5a9b884837546391950a3ec9/certbot-auto chmod +x ./certbot-auto ./certbot-auto --no-self-upgrade 執行 certbot 出現錯誤 Another instance of Certbot is already running 在執行 certbot 時出錯錯誤的訊息\n Another instance of Certbot is already running\n Certbot 不正常關閉，導致原本的 .certbot.lock 檔案還存在於主機中，此時可以透過下方指令找出 .certbot.lock 檔案是否還存在\nfind / -type f -name \".certbot.lock\" 若檔案存在，則可以用下列指令移除所有 .certbot.lock 檔案\nfind / -type f -name \".certbot.lock\" -exec rm {} \\; 移除後再次執行 certbot 就可以正常執行了\n參考資料  How to install Certbot on Ubuntu 16.04 (Auto Cert Renew!) - Ceos3c How To Secure Nginx with Let’s Encrypt on Ubuntu 16.04 | DigitalOcean Get Certbot — Certbot 0.25.0.dev0 documentation How To Secure Nginx with Let’s Encrypt on Ubuntu 16.04 | DigitalOcean How To Secure Apache with Let’s Encrypt on Ubuntu 16.04 | DigitalOcean SSL and nginx missing file: /etc/ssl/certs/dhparam.pem · Issue #10 · ummjackson/mastodon-guide Correct Way to Delete a Certbot SSL Certificate – Matthew Hagemann – Medium With 0.32.0, certbot-auto stopped working for some EOL distributions · Issue #6824 · certbot/certbot · GitHub Another instance of Certbot is already running - Solved - Linux guru  ","categories":["Ubuntu","筆記","文件","網站","Web Software","Build website","SSL","Let's Encrypt","免費憑證"],"description":"Ubuntu SSL Let's Encrypt 建置常用指令","excerpt":"Ubuntu SSL Let's Encrypt 建置常用指令","ref":"/docs/web/ssl/lets-encrypt/","tags":["Ubuntu","筆記","文件","網站","Web Software","Build website","SSL","Let's Encrypt","免費憑證"],"title":"Let's Encrypt"},{"body":"Access Log 依照日期儲存 $time_iso8601 格式\n2014-05-04T18:12:02+02:00 擷取時間 YYYY-MM-DD if ($time_iso8601 ~ \"^(\\d{4})-(\\d{2})-(\\d{2})\") { set $year $1; set $month $2; set $day $3; } access_log /var/log/nginx/$year-$month-$day-access.log; 使用 Perl 擷取時間 if ($time_iso8601 ~ \"^(?\u003cyear\u003e\\d{4})-(?\u003cmonth\u003e\\d{2})-(?\u003cday\u003e\\d{2})\") {} access_log /var/log/nginx/$year-$month-$day-access.log; 擷取 YYYY-MM-DD HH:II:SS if ($time_iso8601 ~ \"^(\\d{4})-(\\d{2})-(\\d{2})T(\\d{2}):(\\d{2}):(\\d{2})\") { set $year $1; set $month $2; set $day $3; set $hour $4; set $minutes $5; set $seconds $6; } Log 路徑 設定檔：\n /etc/nginx/nginx.conf\n access_log /var/log/nginx/access.log; error_log /var/log/nginx/error.log; 參考資料  Log rotation directly within Nginx configuration file - Cambus.net  ","categories":["Ubuntu","筆記","文件","網站","Web Software","Build website","Nginx","Log"],"description":"Ubuntu Nginx Log 建置常用指令","excerpt":"Ubuntu Nginx Log 建置常用指令","ref":"/docs/web/nginx/log/","tags":["Ubuntu","筆記","文件","網站","Web Software","Build website","Nginx","Log"],"title":"Log"},{"body":"參數說明    參數 說明     –progress 顯示同步進度   –delete 刪除存在於目的端，但不存在於來源端的檔案   –exclude-from 排除指定檔案不要刪除   -a 遞迴備份所有子目錄下的目錄與檔案，保留連結檔、檔案的擁有者、群組、權限以及時間戳記   -v 顯示詳細同步的資訊   -h 數字以比較容易閱讀的格式輸出    –exclude-from rsync --delete --exclude-from ./rsyn_exclusion_file 參考資料  Linux 使用 rsync 遠端檔案同步與備份工具教學與範例 - G. T. Wang rsync參數詳解–20100209 @ 暉獲無度的步烙閣 :: 隨意窩 Xuite日誌  ","categories":["Ubuntu","筆記","文件","rsync 指令","rsync"],"description":"Ubuntu 系統 rsync 指令","excerpt":"Ubuntu 系統 rsync 指令","ref":"/docs/command/rsync/","tags":["Ubuntu","筆記","文件","rsync 指令","rsync"],"title":"rsync"},{"body":"參考資料  linux解壓 tar 命令 @ 胖虎的祕密基地 :: 痞客邦 :: Ubuntu Manpage: tar - an archiving utility Ubuntu–tar命令 - Sturtle - 博客园  ","categories":["Ubuntu","筆記","文件","tar 指令","tar"],"description":"Ubuntu 系統 tar 指令","excerpt":"Ubuntu 系統 tar 指令","ref":"/docs/command/tar/","tags":["Ubuntu","筆記","文件","tar 指令","tar"],"title":"tar"},{"body":"行數設定 設定行數\nset nu 取消設定行數\nset nonu set nu! Undo and Redo    說明 指令     Undo u   Redo ctrl+r    編碼 在 Vim 可能會出現文字出現亂碼的狀況，可以指定該文件的編碼，將亂碼資料轉換正確編碼\nset encoding=utf8 設定 vim 預設編碼\nsetglobal fileencoding=utf-8 參考資料  Undo and Redo | Vim Tips Wiki | Fandom VIM 編輯器顯示萬國碼（Unicode）文字，解決亂碼問題 - G. T. Wang  ","categories":["Ubuntu","筆記","文件","編輯器","Editor","Vim"],"description":"Ubuntu 系統編輯器 Vim 常用指令","excerpt":"Ubuntu 系統編輯器 Vim 常用指令","ref":"/docs/editor/vim/","tags":["Ubuntu","筆記","文件","編輯器","Editor","Vim"],"title":"Vim"},{"body":"Shell Function 函式 函式命名 function function_name { command... } function_name () { command... } 參數 shell 使用 $1、$2 去接收參數資料\nfoo() { echo \"Parameter #1 is $1\" } # Parameter #1 is KJ foo KJ 參考資料  Passing parameters to a Bash function - Stack Overflow  ","categories":["Ubuntu","筆記","文件","shell","function","函式"],"description":"Ubuntu 系統 shell 函式常用指令","excerpt":"Ubuntu 系統 shell 函式常用指令","ref":"/docs/shell/function/","tags":["Ubuntu","筆記","文件","shell","function","函式"],"title":"函式"},{"body":"安裝必要套件 如果安裝 php 指令無法執行，請先安裝下列套件\nsudo apt-get update sudo apt-get upgrade sudo apt-get install ca-certificates apt-transport-https software-properties-common 加入 ondrej/php sudo add-apt-repository ppa:ondrej/php 列出 PHP 套件 apt-cache pkgnames | grep php7.1 安裝 php sudo apt-get install php7.1 php7.1-common sudo apt-get install php7.1-curl php7.1-xml php7.1-zip php7.1-gd php7.1-mysql php7.1-mbstring 測試 PHP php -v PHP 7.1.8-2+ubuntu16.04.1+deb.sury.org+4 (cli) (built: Aug 4 2017 13:04:12) ( NTS ) Copyright (c) 1997-2017 The PHP Group Zend Engine v3.1.0, Copyright (c) 1998-2017 Zend Technologies with Zend OPcache v7.1.8-2+ubuntu16.04.1+deb.sury.org+4, Copyright (c) 1999-2017, by Zend Technologies 在 ubuntu 安裝並執行不同 php 版本 安裝其他 php 版本 ------------ Install PHP Modules ------------ $ sudo apt install php5.6-cli php5.6-xml php5.6-mysql $ sudo apt install php7.0-cli php7.0-xml php7.0-mysql $ sudo apt install php7.1-cli php7.1-xml php7.1-mysql $ sudo apt install php7.2-cli php7.2-xml php7.2-mysql $ sudo apt install php7.3-cli php7.3-xml php7.3-mysql 執行指定 php 版本 /usr/bin/php -v /usr/bin/php7.0 -v /usr/bin/php7.1 -v 變更預設 php 執行路徑 ------------ For PHP 5.6 ------------ $ sudo update-alternatives --set php /usr/bin/php5.6 $ php -i | grep \"Loaded Configuration File\" ------------ For PHP 7.0 ------------ $ sudo update-alternatives --set php /usr/bin/php7.0 $ php -i | grep \"Loaded Configuration File\" ------------ For PHP 7.1 ------------ $ sudo update-alternatives --set php /usr/bin/php7.1 $ php -i | grep \"Loaded Configuration File\" ------------ For PHP 7.2 ------------ $ sudo update-alternatives --set php /usr/bin/php7.2 $ php -i | grep \"Loaded Configuration File\" ------------ For PHP 7.3 ------------ $ sudo update-alternatives --set php /usr/bin/php7.3 $ php -i | grep \"Loaded Configuration File\" 安裝 Memcached sudo apt-get install -y php-memcached sudo service php7.0-fpm restart 參考資料  How to Install PHP 8.0 on Ubuntu 20.04 / 18.04 How to upgrade to PHP 7.1 on Ubuntu | Ayesh Karunaratne How to Install and Configure PHP 7.0 or PHP 7.1 on Ubuntu 16.04 - Vultr.com How to Install Different PHP (5.6, 7.0 and 7.1) Versions in Ubuntu  ","categories":["Ubuntu","筆記","文件","網站","Web Software","Build website","PHP","Install Latest PHP version","Install","安裝最新 PHP"],"description":"Ubuntu 安裝最新 PHP 常用指令","excerpt":"Ubuntu 安裝最新 PHP 常用指令","ref":"/docs/web/php/install/","tags":["Ubuntu","筆記","文件","網站","Web Software","Build website","PHP","Install Latest PHP version","Install","安裝最新 PHP"],"title":"安裝最新 PHP"},{"body":"查詢 ubuntu 版本 $ lsb_release -a No LSB modules are available. Distributor ID:\tUbuntu Description:\tUbuntu 16.04.2 LTS Release:\t16.04 Codename:\txenial 參考資料  CheckingYourUbuntuVersion - Community Help Wiki  ","categories":["Ubuntu","筆記","文件","系統"],"description":"Ubuntu 系統常用基本指令","excerpt":"Ubuntu 系統常用基本指令","ref":"/docs/system/","tags":["Ubuntu","筆記","文件","系統"],"title":"系統"},{"body":"監控相關網站  Hyperspin - Free Website Monitoring Uptime Robot UptimeButler Webmon Monitority  ","categories":["Ubuntu","筆記","文件","監控","Monitor","網站監控","Website Monitor"],"description":"Ubuntu 系統網站監控常用指令","excerpt":"Ubuntu 系統網站監控常用指令","ref":"/docs/monitor/websites/","tags":["Ubuntu","筆記","文件","監控","Monitor","網站監控","Website Monitor"],"title":"網站"},{"body":"建立群組 groupadd 建立一個全新的系統群組，可以透過群組統一控制使用者權限\ngroupadd \u003cgroup-name\u003e 查詢使用者群組 groups user1 user1 : \u003cother-groups\u003e www-data getent group www-data www-data:x:33:kejyun,group1 getent group www-data | awk -F: '{print $4}' kejyun,group1 將使用者加入群組 指令加入群組 sudo adduser $USER www-data 編輯群組檔案 sudo vim /etc/group 在每個群組最後面加入相關的使用者，並用逗號隔開\nwww-data:x:33:kejyun,group1,group2 將使用者加入 sudo root sudo adduser 帳號名稱 sudo 變更檔案群組 除了 root 使用者外，沒有人可以將擁有者變更為其他使用者，所以若要變更檔案擁有者的話，必須加上 sudo 權限\n Non-privileged users (not root) cannot chown files to other user names. To use chown, a user must have the privileges of the target user. In other words, only root can give a file to another user.\n sudo chown -R root:root ./folder 參考資料  linux - chown - Operation not permitted - Super User  ","categories":["Ubuntu","筆記","文件","權限","Privilege","群組","Group"],"description":"Ubuntu 系統權限群組設定","excerpt":"Ubuntu 系統權限群組設定","ref":"/docs/privilege/group/","tags":["Ubuntu","筆記","文件","權限","Privilege","群組","Group"],"title":"群組"},{"body":"自動完成指令 Bash auto completion 安裝\nsudo apt update sudo apt install bash-completion 測試\ncat /etc/profile.d/bash_completion.sh 載入\n## source it from ~/.bashrc or ~/.bash_profile ## echo \"source /etc/profile.d/bash_completion.sh\" \u003e\u003e ~/.bashrc ## Another example Check and load it from ~/.bashrc or ~/.bash_profile ## grep -wq '^source /etc/profile.d/bash_completion.sh' ~/.bashrc || echo 'source /etc/profile.d/bash_completion.sh'\u003e\u003e~/.bashrc source /etc/profile.d/bash_completion.sh 變更 Bash 找出目前 shell\necho $SHELL 變更 shell\nchsh -s /bin/bash chsh -s /bin/zsh 參考資料  How to add bash auto completion in Ubuntu Linux - nixCraft  ","categories":["Ubuntu","筆記","文件","軟體","Software","輔助"],"description":"","excerpt":"自動完成指令 Bash auto completion 安裝\nsudo apt update sudo apt install bash-completion 測試\ncat /etc/profile.d/bash_completion.sh 載入\n## source it from ~/.bashrc or ~/.bash_profile ## echo \"source /etc/profile.d/bash_completion.sh\" \u003e\u003e ~/.bashrc ## Another example Check and load it from ~/.bashrc or …","ref":"/docs/software/help/","tags":["Ubuntu","筆記","文件","軟體","Software","輔助"],"title":"輔助"},{"body":"使用 ssh 複製遠端檔案(scp) 使用 ssh\nscp \u003cyour_username\u003e@\u003cyour-server-domain\u003e:/remote/dir/file.txt /local/dir 使用金鑰\nscp -i \u003cyour-key\u003e \u003cyour_username\u003e@\u003cyour-server-domain\u003e:/remote/dir/file.txt /local/dir scp -i ~/.ssh/id_rsa kejyun@127.0.0.1:/home/remote-kejyun/myfile /home/kejyun 複製目錄\n複製目錄加一個 -r 的參數即可\nscp -r -i \u003cyour-key\u003e \u003cyour_username\u003e@\u003cyour-server-domain\u003e:/remote/dir/path /local/dir 參考資料  Run / Execute Command Using SSH - nixCraft linux - How to download a file from server using SSH? - Stack Overflow  ","categories":["Ubuntu","筆記","文件","常用網路指令","網路","Network","ssh","複製遠端檔案(scp)"],"description":"Ubuntu 系統網路 ssh 複製遠端檔案(scp)指令","excerpt":"Ubuntu 系統網路 ssh 複製遠端檔案(scp)指令","ref":"/docs/network/ssh/scp-sync-file/","tags":["Ubuntu","筆記","文件","常用網路指令","網路","Network","ssh","複製遠端檔案(scp)"],"title":"複製遠端檔案(scp)"},{"body":"用指令查詢目前主機 ip 執行下列指令，就可以取得目前所在主機的對外 ip\ndig +short myip.opendns.com @resolver1.opendns.com dig TXT +short o-o.myaddr.l.google.com @ns1.google.com 參考資料  How To Find My Public IP Address From Command Line On a Linux - nixCraft  ","categories":["Ubuntu","筆記","文件","常用網路指令","網路","Network","查詢 ip","ip address"],"description":"Ubuntu 系統網路查詢 ip 指令","excerpt":"Ubuntu 系統網路查詢 ip 指令","ref":"/docs/network/ip/","tags":["Ubuntu","筆記","文件","常用網路指令","網路","Network","查詢 ip","ip address"],"title":"查詢 ip"},{"body":"fastcgi_pass  fastcgi_pass 是指定用來解譯 PHP 程式的端口\n 設定檔 路徑：\n /etc/nginx/site-enabled/xxx\n location ~ \\.php$ { fastcgi_pass unix:/run/php/php7.0-fpm.sock; # fastcgi_pass 127.0.0.1:9000; } 路徑：\n /etc/php/7.0/fpm/pool.d/www.conf\n listen = /run/php/php7.0-fpm.sock ;listen = 127.0.0.1:9000 參考資料  Understanding and Implementing FastCGI Proxying in Nginx | DigitalOcean PHP FastCGI Example | NGINX  ","categories":["Ubuntu","筆記","文件","網站","Web Software","Build website","PHP","fastcgi_pass"],"description":"Ubuntu PHP fastcgi_pass 常用指令","excerpt":"Ubuntu PHP fastcgi_pass 常用指令","ref":"/docs/web/php/fastcgi-pass/","tags":["Ubuntu","筆記","文件","網站","Web Software","Build website","PHP","fastcgi_pass"],"title":"fastcgi_pass"},{"body":"在設定使用 cloudflare 的憑證時，發生了 NET::ERR_CERT_COMMON_NAME_INVALID 的錯誤訊息\nYour connection is not private Attackers might be trying to steal your information from xxx.yyy.kejyun.com (for example, passwords, messages, or credit cards). Learn more NET::ERR_CERT_COMMON_NAME_INVALID Subject: ssl368594.cloudflaressl.com Issuer: COMODO ECC Domain Validation Secure Server CA 2 Expires on: Jan 6, 2020 Current date: Oct 9, 2019 PEM encoded chain: 因為測試的關係，所以需要建立一台 kj.test.kejyun.com 的網址連限制至後方主機，後方主機完全沒有經過 Cloudflare，是使用 Let’s Encrypt 取得可以正常使用的憑證，而 Let’s Encrypt 發送的憑證是給 kj.test.kejyun.com\n而之後要使用 Cloudflare 的憑證做測試，因為 Cloudflare 憑證的驗證方式是 Full 的方式，所以 cloudflare 會驗證後方主機的憑證是否正常\n但此時因為後方的主機憑證是配發給 kj.test.kejyun.com，而 cloudflare 的憑證是配發給 *.kejyun.com，所以 cloudflare 在驗證憑證時發生不匹配的狀況，所以才會出現 NET::ERR_CERT_COMMON_NAME_INVALID 的錯誤訊息\n解決方式  上傳 kj.test.kejyun.com 的憑證至 cloudflare 不要使用過多的子網域當作測試網址，可以使用 kj.kejyun.com 當作測試網址即可通過憑證驗證  ","categories":["Ubuntu","筆記","文件","網站","Web Software","Build website","SSL","NET::ERR_CERT_COMMON_NAME_INVALID"],"description":"Ubuntu SSL NET::ERR_CERT_COMMON_NAME_INVALID 錯誤訊息","excerpt":"Ubuntu SSL NET::ERR_CERT_COMMON_NAME_INVALID 錯誤訊息","ref":"/docs/web/ssl/err-cert-common-name/","tags":["Ubuntu","筆記","文件","網站","Web Software","Build website","SSL","NET::ERR_CERT_COMMON_NAME_INVALID"],"title":"NET::ERR_CERT_COMMON_NAME_INVALID"},{"body":"強制重新導向 HTTP 到 HTTPS 修改 /etc/nginx/site-available/default 裡的網址設定\n重新導向所有網址 server { listen 80 default_server; listen [::]:80 default_server; server_name _; return 301 https://$host$request_uri; } 重新導向指定網址 server { listen 80 default_server; listen [::]:80 default_server; server_name example.com www.example.com; return 301 https://$server_name$request_uri; } Worker 設定 worker_processes 可以設定 worker 行程的數量，可以設定成 CPU 的核心數\n# 4 核心的 CPU worker_processes 4; 設為自動偵測 CPU 核心數\n# 自動偵測 CPU 核心數 worker_processes auto; 設定每個 worker 可同時處理的連線數上限值\nevents { # 同時可處理 1024 條連線 worker_connections 1024; } 連線數上限值\n worker_processes * worker_connections\n 參考資料  Redirect all HTTP requests to HTTPS with Nginx  ","categories":["Ubuntu","筆記","文件","網站","Web Software","Build website","Nginx"],"description":"Ubuntu Nginx 建置常用指令","excerpt":"Ubuntu Nginx 建置常用指令","ref":"/docs/web/nginx/","tags":["Ubuntu","筆記","文件","網站","Web Software","Build website","Nginx"],"title":"Nginx"},{"body":"取得所有的 Server Name 使用 _ 特殊符號取得所有傳進來的 Server Name\nserver { listen 80; server_name example.org www.example.org \"\" 192.168.1.1 ; ... } server { listen 80 default_server; server_name _; return 444; } 參考資料  Nginx Server names  ","categories":["Ubuntu","筆記","文件","網站","Web Software","Build website","Nginx","server_name"],"description":"Ubuntu Nginx server_name 建置常用指令","excerpt":"Ubuntu Nginx server_name 建置常用指令","ref":"/docs/web/nginx/server-name/","tags":["Ubuntu","筆記","文件","網站","Web Software","Build website","Nginx","server_name"],"title":"server_name"},{"body":"參考資料  How to Secure Linux Ubuntu With Two-Factor Authentication  ","categories":["Ubuntu","筆記","文件","權限","Privilege","兩階段驗證","2FA","Two-Factor Authentication"],"description":"Ubuntu 系統登入兩階段驗證 2FA (Two-Factor Authentication)","excerpt":"Ubuntu 系統登入兩階段驗證 2FA (Two-Factor Authentication)","ref":"/docs/privilege/two-factor-authentication/","tags":["Ubuntu","筆記","文件","權限","Privilege","兩階段驗證","2FA","Two-Factor Authentication"],"title":"兩階段驗證 2FA"},{"body":"時區設定 依選項選擇你在的時區 sudo tzselect 更換時區檔 sudo cp /usr/share/zoneinfo/Asia/Taipei /etc/localtime 對時 sudo apt-get install ntpdate sudo ntpdate time.stdtime.gov.tw 時間寫入 BIOS sudo hwclock -w 每日對時 sudo crontab -e cronjob\n0 0 * * * /usr/sbin/ntpdate time.stdtime.gov.tw \u003e /dev/null  若 ntpdate 路徑與我不太一樣，可以使用 which ntpdate 去查看看您的真實路徑為何\n /usr/share/zoneinfo/iso3166.tab: No such file or directory $ sudo tzselect /usr/bin/tzselect: line 180: /usr/share/zoneinfo/iso3166.tab: No such file or directory /usr/bin/tzselect: time zone files are not set up correctly 若在設定時區時出現 /usr/share/zoneinfo/iso3166.tab: No such file or directory 問題，可以重新安裝時區套件即可解決\nsudo apt-get install tzdata 參考資料  [Ubuntu]Ubuntu 更改時區 | Philip@Swarchy Debian User Forums • View topic - Setting time zone  ","categories":["Ubuntu","筆記","文件","系統","時間"],"description":"","excerpt":"時區設定 依選項選擇你在的時區 sudo tzselect 更換時區檔 sudo cp /usr/share/zoneinfo/Asia/Taipei /etc/localtime 對時 sudo apt-get install ntpdate sudo ntpdate time.stdtime.gov.tw 時間寫入 BIOS sudo hwclock -w 每日對時 sudo crontab -e cronjob\n0 0 * * * /usr/sbin/ntpdate time.stdtime.gov.tw \u003e /dev/null  若 ntpdate 路徑與我不太一樣， …","ref":"/docs/system/date/","tags":["Ubuntu","筆記","文件","系統","時間"],"title":"時間"},{"body":"add-apt-repository 指令找不到 sudo: add-apt-repository: command not found 在出現上述指令找不到時，可以安裝下列套件，就可以找到這個指令了\nsudo apt-get install software-properties-common GPG error: https://dl.yarnpkg.com/debian stable InRelease NO_PUBKEY E074D16EB6FF4DE3 在執行 sudo apt-get update 時，出現 NO_PUBKEY 的錯誤訊息\n$ sudo apt-get update Hit:1 https://deb.nodesource.com/node_8.x xenial InRelease Hit:3 http://ap-northeast-1.ec2.archive.ubuntu.com/ubuntu xenial InRelease Get:4 http://ap-northeast-1.ec2.archive.ubuntu.com/ubuntu xenial-updates InRelease [109 kB] Get:5 http://ap-northeast-1.ec2.archive.ubuntu.com/ubuntu xenial-backports InRelease [107 kB] Err:2 https://dl.yarnpkg.com/debian stable InRelease The following signatures couldn't be verified because the public key is not available: NO_PUBKEY 23E7166788B63E1E Get:6 http://ap-northeast-1.ec2.archive.ubuntu.com/ubuntu xenial-updates/main amd64 Packages [957 kB] Get:7 http://security.ubuntu.com/ubuntu xenial-security InRelease [109 kB] Hit:8 http://ppa.launchpad.net/certbot/certbot/ubuntu xenial InRelease Hit:9 http://ppa.launchpad.net/chris-lea/redis-server/ubuntu xenial InRelease Hit:10 http://ppa.launchpad.net/ondrej/php/ubuntu xenial InRelease Fetched 1282 kB in 1s (744 kB/s) Reading package lists... Done W: An error occurred during the signature verification. The repository is not updated and the previous index files will be used. GPG error: https://dl.yarnpkg.com/debian stable InRelease: The following signatures couldn't be verified because the public key is not available: NO_PUBKEY 23E7166788B63E1E W: Failed to fetch https://dl.yarnpkg.com/debian/dists/stable/InRelease The following signatures couldn't be verified because the public key is not available: NO_PUBKEY 23E7166788B63E1E W: Some index files failed to download. They have been ignored, or old ones used instead. 執行更新 key 即可修復這個問題\ncurl -sS https://dl.yarnpkg.com/debian/pubkey.gpg | sudo apt-key add - 列出所有已安裝套件 sudo apt list --installed sudo apt list --installed | less 強制安裝套件，略過 cli 詢問是否安裝 在安裝套件時，常常會遇到 cli 需要詢問是否繼續安裝，像是：\n$ sudo apt-get install php7.2-xml Reading package lists... Done Building dependency tree Reading state information... Done The following additional packages will be installed: libzip4 php7.2-bcmath php7.2-cli php7.2-common php7.2-curl php7.2-dev php7.2-fpm php7.2-gd php7.2-gmp php7.2-imap php7.2-intl php7.2-json php7.2-ldap php7.2-mbstring php7.2-mysql php7.2-opcache php7.2-pgsql php7.2-readline php7.2-soap php7.2-sqlite3 php7.2-zip Suggested packages: dh-php The following packages will be upgraded: libzip4 php7.2-bcmath php7.2-cli php7.2-common php7.2-curl php7.2-dev php7.2-fpm php7.2-gd php7.2-gmp php7.2-imap php7.2-intl php7.2-json php7.2-ldap php7.2-mbstring php7.2-mysql php7.2-opcache php7.2-pgsql php7.2-readline php7.2-soap php7.2-sqlite3 php7.2-xml php7.2-zip 22 upgraded, 0 newly installed, 0 to remove and 405 not upgraded. Need to get 5,739 kB of archives. After this operation, 64.5 kB of additional disk space will be used. Do you want to continue? [Y/n] 如果要跳過詢問的話，可以在參數加入 -y，這樣就可以跳過被詢問的步驟直接安裝\nsudo apt-get install -y php7.2-xml  -y, –yes, –assume-yes\n  Automatic yes to prompts; assume “yes” as answer to all prompts and run non-interactively. If an undesirable situation, such as changing a held package, trying to install a unauthenticated package or removing an essential package occurs then apt-get will abort. Configuration Item: APT::Get::Assume-Yes.\n 參考資料  GPG error: https://dl.yarnpkg.com/debian stable InRelease NO_PUBKEY E074D16EB6FF4DE3 · Issue #4453 · yarnpkg/yarn · GitHub How to List Installed Packages on Ubuntu | Linuxize  ","categories":["Ubuntu","筆記","文件","軟體","Software"],"description":"Ubuntu 系統常用軟體安裝相關指令及常用軟體","excerpt":"Ubuntu 系統常用軟體安裝相關指令及常用軟體","ref":"/docs/software/","tags":["Ubuntu","筆記","文件","軟體","Software"],"title":"軟體"},{"body":"ssh config User\n 登入帳號\n PreferredAuthentications\n 偏好授權方式\n  publickey password  PasswordAuthentication\n 是否使用密碼驗證，預設 yes\n  yes no  PubkeyAuthentication\n 是否使用 public key 驗證，預設 yes\n  yes no  IdentitiesOnly\n 是否只使用 command line 或 config 的 ssh key，預設 no，所以會去嘗試抓其他不同的 key，像是 ssh-agent 的 key\n  yes no  測試 ssh 連線 ssh -T git@github.com ssh -T git@bitbucket.org Bad owner or permissions on ~/.ssh/config 當使用 ssh config 進行連線時會出現權限的問題，表示 config 設定檔案的權限過於不安全，此時只需要限縮 config 檔案的權限即可\nchmod 600 ~/.ssh/config 指定特定的 ssh key 去做 git pull $ GIT_SSH_COMMAND='ssh -i /Users/kejyun/.ssh/id_rsa_other' $ git pull 參考資料  Use multiple ssh-keys for different GitHub accounts on the same computer How to manage multiple SSH key pairs | Enable Sysadmin OpenSSH Config File Examples - nixCraft 如何用config管理多個網站的ssh key和如何不用每一組輸入ssh的Pass Phrase @ Alan Tsai 的學習筆記｜An Asp .Net Mvc Web Developer Blog Bad owner or permissions on ~/.ssh/config - 简书 Specify a specific SSH private key for git pull/git clone  ","categories":["Ubuntu","筆記","文件","常用網路指令","網路","Network","ssh","config"],"description":"Ubuntu 系統網路 ssh config 指令","excerpt":"Ubuntu 系統網路 ssh config 指令","ref":"/docs/network/ssh/config/","tags":["Ubuntu","筆記","文件","常用網路指令","網路","Network","ssh","config"],"title":"ssh config"},{"body":"在 github 抓取 Repository 時，我們常常用 git ssh 帳號去 clone 一個 Repository，像是：\ngit clone git@github.com:laravel/laravel.git 而使用 ssh 去 clone Repository 時，則會需要 ssh 金鑰 才能夠順利的將專案複製下來，但只要有正確的金鑰，我們在每一次對 Repository 進行 clone / push / pull / fetch 的時候，則都不需要輸入帳號密碼即可完成操作（只要你的帳號有足夠的權限的話）\n但當我們有個人的專案及公司的專案都在 github 時，且不同的專案所需要的 ssh 金鑰 皆不同時，則需要設定在不同的狀況需要使用不同的金鑰去存取我們的 Repository。\n例如 git@github.com:kj/kj.git 需要 id_rsa_kj_personal 的金鑰，但 git@github.com:kj-company/compony-project.git 則需要 id_rsa_kj_company 的金鑰\n此時可以使用的解法有下列 2 個\n設定 .ssh/config 檔案 .ssh/config 的設定檔案格式像下方\nHost \u003chost_alias\u003e # 主機別名 HostName \u003chostname_or_ip\u003e # 主機網址或 ip IdentityFile \u003cprivate_key_path\u003e # 金鑰位置 ","categories":["Ubuntu","筆記","文件","常用網路指令","網路","Network","ssh key to same site"],"description":"Ubuntu 系統網路使用不同 ssh 金鑰登入 github 指令","excerpt":"Ubuntu 系統網路使用不同 ssh 金鑰登入 github 指令","ref":"/docs/network/multiple-ssh-key-to-same-github-site/","tags":["Ubuntu","筆記","文件","常用網路指令","網路","Network","ssh key to same site"],"title":"使用不同 ssh 金鑰登入 github"},{"body":"在 Ubuntu 16.04 安裝 MySQL 5.7 sudo apt-get update sudo apt-get install mysql-server mysql-client ","categories":["Ubuntu","筆記","文件","網站","Web Software","Build website","MySQL"],"description":"Ubuntu MySQL 建置常用指令","excerpt":"Ubuntu MySQL 建置常用指令","ref":"/docs/web/mysql/","tags":["Ubuntu","筆記","文件","網站","Web Software","Build website","MySQL"],"title":"MySQL"},{"body":"檢測 /etc/init.d/php7.0-fpm status /etc/init.d/php5-fpm status * php-fpm7.0 is running ps aux | grep php-fpm root 1030 0.0 0.6 326692 23604 ? Ss 5月03 0:03 php-fpm: master process (/etc/php/7.0/fpm/php-fpm.conf) www-data 13671 17.9 0.8 337704 32332 ? S 07:13 0:06 php-fpm: pool www www-data 13672 16.5 0.7 335796 29880 ? S 07:13 0:05 php-fpm: pool www www-data 13692 18.8 0.6 333608 26172 ? S 07:14 0:01 php-fpm: pool www www-data 13695 40.0 0.7 335568 27848 ? S 07:14 0:00 php-fpm: pool www ubuntu 13697 0.0 0.0 12968 956 pts/0 S+ 07:14 0:00 grep --color=auto php-fpm netstat -an | grep :9000 nmap localhost -p 9000 日誌（Log） 1. php-fpm.conf\n[global] error_log = log/error_log [www] catch_workers_output = yes 2. php.ini\nlog_errors = On error_log = \"/usr/local/php/var/log/error_log\" error_reporting=E_ALL\u0026~E_NOTICE 參考資料  PHP FPM - check if running - Stack Overflow  ","categories":["Ubuntu","筆記","文件","網站","Web Software","Build website","PHP","php-fpm"],"description":"Ubuntu php-fpm 常用指令","excerpt":"Ubuntu php-fpm 常用指令","ref":"/docs/web/php/php-fpm/","tags":["Ubuntu","筆記","文件","網站","Web Software","Build website","PHP","php-fpm"],"title":"php-fpm"},{"body":"所有 Sudo 免輸入密碼 編輯 /etc/sudoers 檔案可以修改 Sudoer 權限\nsudo vim /etc/sudoers 將下列設定加上 NOPASSWD\n# 原始 %sudo ALL=(ALL:ALL) ALL # 修改後 %sudo ALL=(ALL:ALL) NOPASSWD:ALL 指定帳號不需要輸入 Sudo 密碼 將所有擁有 Sudo 權限都設定不用密碼會有系統的安全性，所以可以指定特定帳號才能不用輸入密碼\n所以可以在最前方不用密碼的條件設定為指定帳號\n \u003c帳號名稱\u003e ALL=(ALL) NOPASSWD: ALL\n 同樣編輯 /etc/sudoers 檔案，在最下方加入\n# File: /etc/sudoers #includedir /etc/sudoers.d \u003c帳號名稱\u003e ALL=(ALL) NOPASSWD: ALL 指定群組不需要輸入 Sudo 密碼 若有很多帳號不需要輸入 Sudo 密碼，要一筆一筆設定會很累\n所以可以指定使用者群組可以不需要輸入密碼，這樣只需要將使用者加入該群組就有這樣的權限了，這樣只需要統一管理群組名單就可以了\n建立不需要輸入 Sudo 帳號的群組 假設建立的群組名稱為 sudoers-no-password-group，可以使用下列指令建立群組\ngroupadd sudoers-no-password-group 設定群組不需要輸入 Sudo 密碼 接下來編輯 /etc/sudoers 檔案，在最下方加入\n# File: /etc/sudoers %sudoers-no-password-group ALL=(ALL:ALL) NOPASSWD:ALL 使用者加入免輸入密碼群組  sudo adduser \u003c使用者帳號\u003e \u003c免密碼使用者群組\u003e\n sudo adduser kejyun sudoers-no-password-group 加入完成後，僅需要將使用者加入此群組，在群組的使用者就可以不用輸入密碼就有 Sudo 權限了\n參考資料  command line - Execute sudo without Password? - Ask Ubuntu  ","categories":["Ubuntu","筆記","文件","權限","Privilege","群組","Group","sudo no password","免輸入密碼"],"description":"Ubuntu 系統免輸入 Sudo 密碼設定","excerpt":"Ubuntu 系統免輸入 Sudo 密碼設定","ref":"/docs/privilege/sudo-no-passowrd/","tags":["Ubuntu","筆記","文件","權限","Privilege","群組","Group","sudo no password","免輸入密碼"],"title":"Sudo 權限免密碼"},{"body":"查詢主機名稱 直接在命令列輸入 hostname 就可以看到目前的主機名稱\nhostname 變更主機 hostname 1. 修改主機名稱\n使用編輯器修改 /etc/hostname 檔案，將 hostname 改為您要呈現的主機名稱\nsudo vim /etc/hostname 修正完的 hostname 會長這樣\n# /etc/hostname kejyun-host-name 2. 加入主機名稱對應 ip\n在修改主機名稱後，因為有些服務 IP 是對應到舊的主機名稱，所以新的名稱需要自行指定到本機 127.0.0.1\nsudo vim /etc/hosts # /etc/hosts 127.0.0.1 kejyun-host-name 3. 強制更改主機名稱\n修改完成後，可以下指令強制更新主機名稱，然後再重新登入就可以看到主機名稱已經被修改了\nsudo hostname -F /etc/hostname kj@kejyun-host-name:~$ 參考資料  ubuntu 14.04 設定hostname  ","categories":["Ubuntu","筆記","文件","系統","主機名稱","hostname"],"description":"","excerpt":"查詢主機名稱 直接在命令列輸入 hostname 就可以看到目前的主機名稱\nhostname 變更主機 hostname 1. 修改主機名稱\n使用編輯器修改 /etc/hostname 檔案，將 hostname 改為您要呈現的主機名稱\nsudo vim /etc/hostname 修正完的 hostname 會長這樣\n# /etc/hostname kejyun-host-name 2. 加入主機名稱對應 ip\n在修改主機名稱後，因為有些服務 IP 是對應到舊的主機名稱，所以新的名稱需要自行指定到本機 127.0.0.1\nsudo vim /etc/hosts # /etc/hosts …","ref":"/docs/system/hostname/","tags":["Ubuntu","筆記","文件","系統","主機名稱","hostname"],"title":"主機名稱 hostname"},{"body":"在執行 curl 的時候，主機噴出 server certificate verification failed. CAfile: /etc/ssl/certs/ca-certificates.crt 憑證過期的錯誤訊息，此時需要重新更新主機憑證資訊\n$ curl https://www.google.com curl: (60) server certificate verification failed. CAfile: /etc/ssl/certs/ca-certificates.crt CRLfile: none More details here: http://curl.haxx.se/docs/sslcerts.html curl performs SSL certificate verification by default, using a \"bundle\" of Certificate Authority (CA) public keys (CA certs). If the default bundle file isn\\'t adequate, you can specify an alternate file using the --cacert option. If this HTTPS server uses a certificate signed by a CA represented in the bundle, the certificate verification probably failed due to a problem with the certificate (it might be expired, or the name might not match the domain name in the URL). If you\\'d like to turn off curl\\'s verification of the certificate, use the -k (or --insecure) option. 更新主機套件\n因為主機套件沒有更新的話，抓取的憑證資料可能還會是舊的憑證，所以在更新憑證之前要先更新主機套件版本\nsudo apt-get update 更新主機憑證\n更新完主機套件後，就可以重新安裝憑證套件程式，讓主機抓取最新的憑證\nsudo apt-get install --reinstall ca-certificates 若套件已是最新的，要直接更新憑證，可以使用下列指令直接更新即可\nsudo update-ca-certificates 參考資料  服务器证书验证失败CAfile:/etc/ssl/certs/ca certificates.crt CRLfile: 无_ssl-certificate_酷徒编程知识库 各系統更新 ca (root)根憑證的方法 – Mr. 沙先生  ","categories":["Ubuntu","筆記","文件","網站","Web Software","Build website","SSL","更新憑證"],"description":"Ubuntu SSL 更新憑證常用指令","excerpt":"Ubuntu SSL 更新憑證常用指令","ref":"/docs/web/ssl/certificate-verification-failed/","tags":["Ubuntu","筆記","文件","網站","Web Software","Build website","SSL","更新憑證"],"title":"更新憑證"},{"body":"變更密碼 變更指定使用者密碼\nsudo passwd USERNAME 變更目前使用者密碼\nsudo passwd 變更自己帳號密碼\npasswd 刪除使用者 sudo deluser USERNAME sudo deluser --remove-home USERNAME 參考資料  How to Add and Delete Users on Ubuntu 16.04 | DigitalOcean  ","categories":["Ubuntu","筆記","文件","權限","Privilege"],"description":"Ubuntu 系統權限設定","excerpt":"Ubuntu 系統權限設定","ref":"/docs/privilege/","tags":["Ubuntu","筆記","文件","權限","Privilege"],"title":"權限"},{"body":"設定需要驗證網址路徑 在網站設定中，設定需要驗證的目錄\nlocation / { # 驗證方式 auth_basic \"Restricted\"; # 驗證檔案 auth_basic_user_file htpasswd; try_files $uri $uri/ /index.php?$query_string; } 驗證檔案 在 /etc/nginx/ 目錄下建立 htpasswd 檔案（/etc/nginx/htpasswd）\n/etc/nginx $ touch htpasswd 建立驗證密碼 使用 openssl 建立加密的密碼\nopenssl passwd Password: Verifying - Password: ZEmF5bjIAXRb6 設定帳號密碼 auth_basic_user_file 檔案格式\n帳號1:密碼1 帳號2:密碼2:註解 帳號3:密碼3 將建立的密碼設定在 /etc/nginx/htpasswd 檔案中\ntest:ZEmF5bjIAXRb6 設定完成之後，重新啟動 nginx，就可以使用 nginx 限制連線存取的帳號密碼了～\n參考資料  NGINX 設定密碼認證與限制可存取的 IP 位址，控制頻寬與連線數 - G. T. Wang  ","categories":["Ubuntu","筆記","文件","網站","Web Software","Build website","Nginx","認證","auth"],"description":"Ubuntu Nginx 認證 auth 建置常用指令","excerpt":"Ubuntu Nginx 認證 auth 建置常用指令","ref":"/docs/web/nginx/auth/","tags":["Ubuntu","筆記","文件","網站","Web Software","Build website","Nginx","認證","auth"],"title":"認證"},{"body":"執行遠端 ssh 登入並執行遠端主機指令 在連線主機後若要立即在遠端主機執行指令的話，可以在 ssh 指令 後面用單引號（'）或雙引號（\"）將要執行的指令包起來，這樣在 ssh 連線後就會立即在遠端主機執行該指令\nssh kejyun@127.0.0.1 '\u003cremote_scripts\u003e' ssh kejyun@127.0.0.1 \"\u003cremote_scripts\u003e\" ssh kejyun@127.0.0.1 '/home/kejyun/shell.sh' ssh kejyun@127.0.0.1 \"sudo /home/kejyun/shell.sh argument1 argument2\" ","categories":["Ubuntu","筆記","文件","常用網路指令","網路","Network","ssh","執行遠端主機指令"],"description":"Ubuntu 系統網路 ssh 執行遠端主機指令","excerpt":"Ubuntu 系統網路 ssh 執行遠端主機指令","ref":"/docs/network/ssh/execute-remote-scripts/","tags":["Ubuntu","筆記","文件","常用網路指令","網路","Network","ssh","執行遠端主機指令"],"title":"執行遠端主機指令"},{"body":"在 MacOS Mojave 版本產生的 ssh key 無法使用 Mojave 的 ssh key 產生的 key 是新版本的 OPENSSH private key，所以在許多還沒支援新版本的平台使用此金鑰會無法被識別\nssh-keygen -t rsa -b 4096 -C \"kj@kejyun.com\" -----BEGIN OPENSSH PRIVATE KEY----- b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAACFwAAAAdzc2gtcn NhAAAAAwEAAQAAAgEA3Vnc+Hc5835QtKskY/oC9pFrnv6JSnMi7gQHc6aLZOCBE5IKklgq 8P+O8aImqQUEv2GhLIIkMMmRm60U7t78/JiNtLHP07BIqxXslcTaWi9D1bUWcooBgqB/qy Hvg8J0QAmYBwbgaYzU8vgOckUgxQ/ssiFb1VkCsyuDvjCpjCJ0nwXNPlR2P1iYEuIpen7D 2uS+0iSCRmmJAAAAGXJheS5jaGVuZ0B0aGVuZXdzbGVucy5jb20B -----END OPENSSH PRIVATE KEY----- 為了解決這個問題可以加入 -m PEM 參數，產生 PEM 格式的 key\nssh-keygen -m PEM -t rsa -b 4096 -C \"kj@kejyun.com\" -----BEGIN RSA PRIVATE KEY----- MIIJKQIBAAKCAgEAr+QHvQMVt5i2ZzkHMxl/PRXxkFD2rHdLx1RT+9E9Hie/FeO3 5DJMU+ZKZiPCK3ya/hDj8xJukL7jLfjhmGNKFDnkCGTzyhU5jWlORDEez72NKHGP eAt4eO6w6MpvRyhg7FZakKsTvLbGu7P8ceBA2yy6LHWUUDWuXPx4ZvarSr9q5Vkf qgGfICykPJEa0g68kyFJORLfaHrqgsrzmuHlJwokP8Jetw53MF+dciA/nE42tW4M rsiU0zzbEUYpS15uuR31QZjeNzGduwOU+gPBuhTdB3IaXyXD7KfSs6vXsaIB -----END RSA PRIVATE KEY----- ","categories":["Ubuntu","筆記","文件","常用網路指令","網路","Network","ssh","產生的金鑰無法使用"],"description":"Ubuntu 系統網路 ssh 產生的金鑰無法使用","excerpt":"Ubuntu 系統網路 ssh 產生的金鑰無法使用","ref":"/docs/network/ssh/question/key-unavailable/","tags":["Ubuntu","筆記","文件","常用網路指令","網路","Network","ssh","產生的金鑰無法使用"],"title":"產生的金鑰無法使用"},{"body":"PHP FPM Error log 設定檔：\n /etc/php/7.0/fpm/php-fpm.conf\n error_log = /var/log/php7.0-fpm.log ","categories":["Ubuntu","筆記","文件","網站","Web Software","Build website","PHP","log"],"description":"Ubuntu PHP log 常用指令","excerpt":"Ubuntu PHP log 常用指令","ref":"/docs/web/php/log/","tags":["Ubuntu","筆記","文件","網站","Web Software","Build website","PHP","log"],"title":"log"},{"body":"檔案路徑 設定檔\nsudo vim /etc/php/7.1/fpm/php-fpm.conf 核心設定檔案\nsudo vim /etc/php/7.1/fpm/pool.d/www.conf Log 檔案\nsudo vim /var/log/php7.1-fpm.log ","categories":["Ubuntu","筆記","文件","網站","Web Software","Build website","PHP"],"description":"Ubuntu PHP 建置常用指令","excerpt":"Ubuntu PHP 建置常用指令","ref":"/docs/web/php/","tags":["Ubuntu","筆記","文件","網站","Web Software","Build website","PHP"],"title":"PHP"},{"body":"建立放憑證目錄 sudo mkdir /etc/nginx/ssl 建立憑證 sudo openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/nginx/ssl/nginx.key -out /etc/nginx/ssl/nginx.crt Country Name (2 letter code) [AU]:TW State or Province Name (full name) [Some-State]:Taiwan Locality Name (eg, city) []:Taipei Organization Name (eg, company) [Internet Widgits Pty Ltd]:My Company Organizational Unit Name (eg, section) []:My Unit Common Name (e.g. server FQDN or YOUR name) []: Email Address []:kj@kejyun.com 加入憑證至設定檔 server { listen 80 default_server; listen [::]:80 default_server; # 加入 SSL 設定 listen 443 ssl default_server; listen [::]:443 ssl default_server; # 憑證與金鑰的路徑 ssl_certificate /etc/nginx/ssl/nginx.crt; ssl_certificate_key /etc/nginx/ssl/nginx.key; # ... } sudo service nginx restart 參考資料  NGINX 設定 HTTPS 網頁加密連線，建立自行簽署的 SSL 憑證 - G. T. Wang  ","categories":["Ubuntu","筆記","文件","網站","Web Software","Build website","Nginx","憑證","cert"],"description":"Ubuntu Nginx 憑證 cert 建置常用指令","excerpt":"Ubuntu Nginx 憑證 cert 建置常用指令","ref":"/docs/web/nginx/cert/","tags":["Ubuntu","筆記","文件","網站","Web Software","Build website","Nginx","憑證","cert"],"title":"憑證"},{"body":"指令結果不要輸出 \u003e/dev/null 2\u003e\u00261\n /dev/null：空文件   ：代表重新導向到哪里，例如：echo “123” \u003e /home/123.txt\n  1：表示 stdout 標準輸出，系統預設值是1，所以 \u003e/dev/null 等同於 1\u003e/dev/null 2：表示 stderr 標準錯誤 \u0026：表示等同於的意思，2\u003e\u00261，表示 2 的輸出重新導向等同於1  renice -20 `cat /home/yoursrcdspath/srcds.pid` \u003e/dev/null 2\u003e\u00261 global bash profile 在 /etc/profile 設定的指令，所有使用者都可以使用\nsudo vim /etc/profile 參考資料  Linux Shell 1\u003e/dev/null 2\u003e\u00261 含义 - CSDN博客 孤島日誌: Unix 重新導向跟 2\u003e\u00261  ","categories":["Ubuntu","筆記","文件","常用指令","Common Command"],"description":"Ubuntu 系統常用指令","excerpt":"Ubuntu 系統常用指令","ref":"/docs/command/","tags":["Ubuntu","筆記","文件","常用指令","Common Command"],"title":"指令"},{"body":"確認記憶體使用狀況 free -m $ free -m total used free shared buff/cache available Mem: 990 164 197 38 628 584 Swap: 0 0 0 $ free -m total used free shared buffers cached Mem: 992 867 125 20 63 516 -/+ buffers/cache: 287 704 Swap: 1023 0 1023 設定 Swap File 設定 4G 的 SWAP 檔案\nsudo -s cd /var fallocate -l 4G swapfile.1 chmod 600 swapfile.1 設定此檔案只能被 root 讀寫，以防安全性問題\n啟用 SWAP mkswap /var/swapfile.1 swapon /var/swapfile.1 查詢目前 SWAP 路徑 $ swapon -s $ swapon -s Filename\tType\tSize\tUsed\tPriority /var/swapfile.1 file 4194300\t0\t-1 讓 Swap file 重開機後也能自動啟動 請確認您的 swap 檔案路徑為 /var/swapfile.1，如果有自定義其他 swap 檔案名稱，請將 swap 檔案路徑改為您的路徑，否則會導致無法開機\necho \"/var/swapfile.1 none swap sw 0 0\" \u003e\u003e /etc/fstab 使用 htop 監控記憶體使用狀況 sudo apt-get install htop 設定 swappiness 調整 swap 使用優先權 swappiness 數值介於 0~100，越接近 100 則系統越常使用 swap，越接近 0 則系統會越常使用 RAM，預設為 60，為了系統效能，可以盡量將此設定值調低\n查詢 swappiness\ncat /proc/sys/vm/swappiness 設定 swappiness\nsysctl vm.swappiness=10 設定重新開機時 swappiness 數值\necho \"vm.swappiness = 10\" \u003e\u003e /etc/sysctl.conf 參考資料  在 Ubuntu VPS 上設定虛擬記憶體 (Swap) 來解決RAM不夠用的問題 « 峰哥的技術日誌 memory - How do I find out if I have a swap partition on my hard drive? - Ask Ubuntu  ","categories":["Ubuntu","筆記","文件","系統","虛擬記憶體","SWAP"],"description":"","excerpt":"確認記憶體使用狀況 free -m $ free -m total used free shared buff/cache available Mem: 990 164 197 38 628 584 Swap: 0 0 0 $ free -m total used free shared buffers cached Mem: 992 867 125 20 63 516 -/+ buffers/cache: 287 704 Swap: 1023 0 1023 設定 Swap File 設定 4G 的 SWAP 檔案\nsudo -s cd /var fallocate -l 4G …","ref":"/docs/system/virtual-memory/","tags":["Ubuntu","筆記","文件","系統","虛擬記憶體","SWAP"],"title":"虛擬記憶體（SWAP）"},{"body":"列出所有服務 port sudo lsof -iTCP -sTCP:LISTEN -P ","categories":["Ubuntu","筆記","文件","常用網路指令","網路","Network"],"description":"Ubuntu 系統常用網路指令","excerpt":"Ubuntu 系統常用網路指令","ref":"/docs/network/","tags":["Ubuntu","筆記","文件","常用網路指令","網路","Network"],"title":"網路"},{"body":"有些主機會因為安全性的疑慮，所以關閉對外連線的 port，但如果我們可以透過 ssh 連線至主機時，可以透過 ssh tunnel\n指令  ssh -L \u003c本地端 port\u003e:\u003c遠端主機 ip / dns\u003e:\u003c遠端主機 port\u003e \u003cssh 連線遠端主機 ip / dns\u003e\n  ssh -L \u003clocal-port\u003e:\u003cremote-server-ip-or-dns\u003e:\u003cremote-port\u003e \u003cssh-to-remote-server-ip-or-dns\u003e\n 連線資料庫範例 ssh -L 33306:mysql.kejyun.com:3306 kj@mysql.kejyun.com 連線完成後，就可以在本地端透過 127.0.0.1 的 33306 port 連線至遠端的資料庫\n連線網頁範例 ssh -L 8080:web.kejyun.com:80 kj@web.kejyun.com 連線完成後就可以在本地端透過 http://127.0.0.1:8080/ 連線至遠端網頁的 80 port\n參數說明    說明 參數     建立本地端 port forwarding -L   背景執行 -f   不要執行遠端指令 -N    不要執行遠端指令並在背景執行範例 ssh -L 33306:mysql.kejyun.com:3306 -N -f kj@mysql.kejyun.com 除錯 列出目前所有 SSH Tunnel lsof -i -n | egrep '\\\u003cssh\\\u003e' 參考資料  How to Set up SSH Tunneling (Port Forwarding) | Linuxize How to Use SSH Port Forwarding {Ultimate Guide} How to Create SSH Tunneling or Port Forwarding in Linux [教學] 透過 SSH Tunnel 將伺服器內部服務綁定到本機電腦上 | 辛比誌  ","categories":["Ubuntu","筆記","文件","常用網路指令","網路","Network","ssh","ssh tunnel","port 轉發","port forward"],"description":"Ubuntu 系統網路 ssh 指令進行連線的本地端 ssh tunnel，將資料 port 轉發至遠端主機","excerpt":"Ubuntu 系統網路 ssh 指令進行連線的本地端 ssh tunnel，將資料 port 轉發至遠端主機","ref":"/docs/network/ssh/ssh-tunnel-port-forward/","tags":["Ubuntu","筆記","文件","常用網路指令","網路","Network","ssh","ssh tunnel","port 轉發","port forward"],"title":"ssh tunnel 連線 port 轉發"},{"body":"參數說明    參數 說明     gzip on on = enable, off = disable   gzip_buffers 16 8k 壓縮回應內容   gzip_comp_level 6 壓縮等級，可設定 1 ~ 9 的整數，數字越大表示壓縮的量越大，也越吃資源，請看個人環境而定   gzip_disable “msie6” 設定不壓縮的條件，視 Request Header 中的 User-Agent 而定。可以設定 Regular Expression，例如: msie[4-6]   gzip_min_length 1k 文件內容小於 n 以下不壓縮，這裡的文件內容指的是 Response Header 的 Content-Length，一樣視個人需求而定，沒有標準值   gzip_http_version 1.1 設定至少接受的 Http Version   gzip_proxied any 決定對來自 Proxy 的 Request 如何處理   gzip_types [mime-types] 指定需要壓縮的 MIME types，或用 * 表示所有 MIME types   gzip_vary on 要不要在 Response Header “Vary: Accept-Encoding”    gzip_comp_level - 壓縮等級 text/html - phpinfo(): 0 55.38 KiB (100.00% of original size) 1 11.22 KiB ( 20.26% of original size) 2 10.89 KiB ( 19.66% of original size) 3 10.60 KiB ( 19.14% of original size) 4 10.17 KiB ( 18.36% of original size) 5 9.79 KiB ( 17.68% of original size) 6 9.62 KiB ( 17.37% of original size) 7 9.50 KiB ( 17.15% of original size) 8 9.45 KiB ( 17.06% of original size) 9 9.44 KiB ( 17.05% of original size) application/x-javascript - jQuery 1.8.3 (Uncompressed) 0 261.46 KiB (100.00% of original size) 1 95.01 KiB ( 36.34% of original size) 2 90.60 KiB ( 34.65% of original size) 3 87.16 KiB ( 33.36% of original size) 4 81.89 KiB ( 31.32% of original size) 5 79.33 KiB ( 30.34% of original size) 6 78.04 KiB ( 29.85% of original size) 7 77.85 KiB ( 29.78% of original size) 8 77.74 KiB ( 29.73% of original size) 9 77.75 KiB ( 29.74% of original size)  如果有更多的 CPU 資源，可以將壓縮等級設為 9，因為壓縮比例在 1 之後並沒有差異太大，對大部分的網站，gzip 設為 2 應該就足夠了\n Example http { gzip on; gzip_min_length 1000; gzip_types *; gzip_comp_level 2; gzip_proxied any; gzip_buffers 16 8k; gzip_http_version 1.1; } 參考資料  Enable gzip compression with nginx Module ngx_http_gzip_module What is the best nginx compression gzip level? - Server Fault Finding the Nginx gzip_comp_level Sweet Spot | Mjanja Tech  ","categories":["Ubuntu","筆記","文件","網站","Web Software","Build website","Nginx","壓縮","Gzip"],"description":"Ubuntu Nginx Gzip 建置常用指令","excerpt":"Ubuntu Nginx Gzip 建置常用指令","ref":"/docs/web/nginx/gzip/","tags":["Ubuntu","筆記","文件","網站","Web Software","Build website","Nginx","壓縮","Gzip"],"title":"Gzip"},{"body":"PHP FPM Max Children 在 php fpm 的 error log 發現執行緒不太夠用，需要設定開啟新執行緒\n[24-Oct-2018 07:43:58] WARNING: [pool www] server reached pm.max_children setting (5), consider raising it [24-Oct-2018 08:27:52] WARNING: [pool www] server reached pm.max_children setting (5), consider raising it [24-Oct-2018 10:57:17] WARNING: [pool www] server reached pm.max_children setting (5), consider raising it [24-Oct-2018 11:37:32] WARNING: [pool www] server reached pm.max_children setting (5), consider raising it 設定檔路徑\n/etc/php/7.1/fpm/pool.d/www.conf 在設定檔中可以看到類似以下的設定方式\npm.max_children = 10 pm.start_servers = 4 pm.min_spare_servers = 2 pm.max_spare_servers = 8 Process Manager 行程調配規則參數說明    參數 說明     pm PHP-FPM Process Manager 行程調配規則   pm.start_servers PHP-FPM 服務在一開始啟動時，要配置多少個行程   pm.min_spare_servers PHP-FPM 最小閒置行程的數量   pm.max_spare_servers PHP-FPM 最大閒置行程的數量   pm.max_requests 單一 PHP-FPM 最多可以處理多少個連線，當一個工作行程處理的連線數達到這個值的時候，就會強制關閉此行程，重新產生另一個新的行程    pm = dynamic    參數 說明     static 固定行程數量（數量為 pm.max_children） ，效能很好，但很佔記憶體   dynamic 動態行程數量（根據 pm.max_children、pm.start_servers、pm.min_spare_servers、pm.max_spare_servers 動態調整），根據使用量用多少開多少，但當使用量比較低時，會保留一些行程，隨時等著接收新的連線   ondemand 動態行程數量（根據 pm.max_children、pm.start_servers、pm.min_spare_servers、pm.max_spare_servers 動態調整），用多少開多少    pm.max_children 最大執行程序數量 最大執行程序數量是針對自己的主機規格不同去做設定的，當你主機有較大的記憶體，則可以設定更多的執行程序\n Total Max Processes = (Total Ram - (Used Ram + Buffer)) / (Memory per php process)\n  最大執行程序 = (總記憶體 - (已使用記憶體 + Buffer)) / (每個 php 執行緒需要記憶體)\n  pm.max_children 數量：可用記憶體(MB) / 大約 50MB\n 確認每個 php 執行緒需要記憶體\n因為每個 php 執行的記憶體及效率會針對不同的程式環境不同，而有不同的消耗記憶體，可以使用下列指令去取得 php-fpm 執行緒消耗的記憶體數量\n ps -ylC php-fpm 執行緒完整名稱 –sort:rss\n 範例\n其中的 php-fpm 執行緒完整名稱 要看看你系統是用哪個版本的 php，而會有不同版本名稱的 php-fpm，像是：\nps -ylC php-fpm --sort:rss ps -ylC php-fpm7.0 --sort:rss ps -ylC php-fpm7.1 --sort:rss 在列出來 php-fpm 使用的資源後，可以看到 RSS 欄位為使用的記憶體大小，31692 表示為 31692 kb，大概就是 31M\n$ ps -ylC php-fpm7.1 --sort:rss S UID PID PPID C PRI NI RSS SZ WCHAN TTY TIME CMD S 33 22275 16692 1 80 0 31692 212882 - ? 08:00:00 php-fpm7.0 S 33 22092 16692 1 80 0 40708 231684 - ? 08:00:02 php-fpm7.0 S 33 22023 16692 1 80 0 41136 231888 - ? 08:00:05 php-fpm7.0 S 33 22038 16692 1 80 0 41204 231744 - ? 08:00:04 php-fpm7.0 但每個 php-fpm 程序的記憶體不盡相同，我們可以用下列指令去計算平均使用的記憶體大小是多少\n ps –no-headers -o “rss,cmd” -C php-fpm 執行緒完整名稱 | awk ‘{ sum+=$1 } END { printf (\"%d%s\\n\", sum/NR/1024,“Mb”) }’\n 也是一樣針對你系統是用哪個版本的 php，而會有不同版本名稱的 php-fpm，像是：\nps --no-headers -o \"rss,cmd\" -C php-fpm | awk '{ sum+=$1 } END { printf (\"%d%s\\n\", sum/NR/1024,\"Mb\") }' ps --no-headers -o \"rss,cmd\" -C php-fpm7.0 | awk '{ sum+=$1 } END { printf (\"%d%s\\n\", sum/NR/1024,\"Mb\") }' ps --no-headers -o \"rss,cmd\" -C php-fpm7.1 | awk '{ sum+=$1 } END { printf (\"%d%s\\n\", sum/NR/1024,\"Mb\") }' 抓出來的平均使用記憶體大概為 44 MB，但為了抓 Buffer，我們大概抓 50 MB 左右\n$ ps --no-headers -o \"rss,cmd\" -C php-fpm7.0 | awk '{ sum+=$1 } END { printf (\"%d%s\\n\", sum/NR/1024,\"Mb\") }' 44Mb 確認可用的記憶體數量\n php-fpm 可以用的記憶體為：剩餘還可用的記憶體 + (php-fpm 平均使用記憶體 * 目前 php-fpm 開啟數量)\n 使用 free -m 取得目前的記憶體使用狀況，總記憶體是 3272 M，已經使用了 1539M，剩餘還可用的記憶體有 1021 M\n$ free -m total used free shared buff/cache available Mem: 3762 1539 1021 84 2417 2686 Swap: 0 0 0 而從下列指令中，取得 php-fpm 平均使用記憶體為 44M\n ps –no-headers -o “rss,cmd” -C php-fpm 執行緒完整名稱 | awk ‘{ sum+=$1 } END { printf (\"%d%s\\n\", sum/NR/1024,“Mb”) }’\n 從下列指令中列出目前所有 php-fpm 執行緒數量為 41 個（直接去計算清單出現幾行 php-fpm 資源狀況即可知道總共開了幾個 php-fpm 執行緒）\n ps -ylC php-fpm 執行緒完整名稱 –sort:rss\n 所以 php-fpm 可以用的記憶體為 1021 M + 44 M * 41 個 = 2743M\n 最大執行程序數量 = php-fpm 可以用的記憶體 / 每個 php 執行緒需要記憶體(Buffer 數值)\n 2743M / 50M = 54.86\n為了不要讓所有記憶題全部消耗完，而沒有空間去執行其他非 php 的程序，所以我們這邊會抓 pm.max_children 大概最多使用個 50 個 執行緒\npm.max_children = 50 start_server 官方建議算法是 min_spare_servers + (max_spare_servers - min_spare_servers) / 2\nmin_spare_servers 跟 max_spare_servers 就取個大概就好，不要讓他一直開開關關即可\npm.start_servers = 20 pm.min_spare_servers = 13 pm.max_spare_servers = 26 防止 php-fpm 執行緒處理過多 request 導致 Memory leak pm.max_requests = 500 request_terminate_timeout = 30s 讓每個子執行緒同時處理超過 500 個 request 就自動移除此執行緒，避免 Memory Leak 執行緒卡在那邊動彈不得\n而執行時間超過 30 秒的請求則自動中斷掉，建議設定為與 php.ini 的 max_execution_time 相同\n最後設定值會像是：\npm = dynamic pm.max_children = 50 pm.start_servers = 20 pm.min_spare_servers = 13 pm.max_spare_servers = 26 pm.max_requests = 500 request_terminate_timeout = 30s 記錄觀察 為了持續觀察 php-fpm 執行序地處理狀況，我們可以把請求執行時間過慢的 Request 記錄下來，在之後後續可以持續做除錯改進，這裡設定紀錄執行超過 10 秒的執行緒狀況\n; slowlog = /var/log/php7.0-fpm-$pool.log.slow slowlog = /var/log/php7.1-fpm-$pool.log.slow request_slowlog_timeout = 10s 設定完成後可以進行測試，確認改過的設定檔案沒有問題\nphp-fpm7.0 -t php-fpm7.1 -t $ php-fpm7.1 -t [03-Jul-2019 15:53:15] NOTICE: configuration file /etc/php/7.1/fpm/php-fpm.conf test is successful 確認後記得重啟 php-fpm 服務即可生效\nsudo service php7.0-fpm restart sudo service php7.1-fpm restart 參考資料  Nginx 與 PHP-FPM 最佳化效能設定教學與技巧 - G. T. Wang Determining the correct number of child processes for PHP-FPM on NGinx 【整理】php-fpm.conf中的pm.max_children到底应该设置为多少 – 在路上 PHP-FPM: Process Management | Servers for Hackers Determining the correct number of child processes for PHP-FPM on NGinx How To: Solve PHP-FPM server reached max_children | Webcore Community | Webcore Cloud  ","categories":["Ubuntu","筆記","文件","網站","Web Software","Build website","PHP","max_children"],"description":"Ubuntu PHP max_children 常用指令","excerpt":"Ubuntu PHP max_children 常用指令","ref":"/docs/web/php/max-children/","tags":["Ubuntu","筆記","文件","網站","Web Software","Build website","PHP","max_children"],"title":"max_children"},{"body":"","categories":["Ubuntu","筆記","文件","網站","Web Software","Build website","SSL"],"description":"Ubuntu SSL 建置常用指令","excerpt":"Ubuntu SSL 建置常用指令","ref":"/docs/web/ssl/","tags":["Ubuntu","筆記","文件","網站","Web Software","Build website","SSL"],"title":"SSL"},{"body":"","categories":["Ubuntu","筆記","文件","網站","Web Software","Build website"],"description":"Ubuntu 系統網站建置常用指令","excerpt":"Ubuntu 系統網站建置常用指令","ref":"/docs/web/","tags":["Ubuntu","筆記","文件","網站","Web Software","Build website"],"title":"網站"},{"body":"解決語系 perl: warning: Falling back to the standard locale (\"C\"). 錯誤訊息 perl: warning: Setting locale failed. perl: warning: Please check that your locale settings: LANGUAGE = (unset), LC_ALL = (unset), LC_CTYPE = \"UTF-8\", LANG = \"en_US.UTF-8\" are supported and installed on your system. perl: warning: Falling back to the standard locale (\"C\"). Solution\n在命令列輸入下列指令即可\nexport LANGUAGE=en_US.UTF-8 export LANG=en_US.UTF-8 export LC_ALL=en_US.UTF-8 locale-gen en_US.UTF-8 sudo dpkg-reconfigure locales 參考資料  solve perl: warning: Setting locale failed. · GitHub  ","categories":["Ubuntu","筆記","文件","系統","語系","locale","language"],"description":"","excerpt":"解決語系 perl: warning: Falling back to the standard locale (\"C\"). 錯誤訊息 perl: warning: Setting locale failed. perl: warning: Please check that your locale settings: LANGUAGE = (unset), LC_ALL = (unset), LC_CTYPE = \"UTF-8\", LANG = \"en_US.UTF-8\" are supported and installed on your system. perl: warning: …","ref":"/docs/system/language/","tags":["Ubuntu","筆記","文件","系統","語系","locale","language"],"title":"語系"},{"body":"site conf 設定 http { # 靜態檔案快取規則 # 快取設定及 HTML 檔案及資料 location ~* \\.(?:manifest|appcache|html?|xml|json)$ { expires -1; # access_log logs/static.log; # I don't usually include a static log } # Feed location ~* \\.(?:rss|atom)$ { expires 1h; add_header Cache-Control \"public\"; } # 媒體：圖片、圖示、影片、音樂 location ~* \\.(?:jpg|jpeg|gif|png|ico|cur|gz|svg|svgz|mp4|ogg|ogv|webm|htc)$ { expires 1M; access_log off; add_header Cache-Control \"public\"; } # CSS 及 Javascript location ~* \\.(?:css|js)$ { expires 1y; access_log off; add_header Cache-Control \"public\"; } } 參考資料  Nginx Caching - Servers for Hackers  ","categories":["Ubuntu","筆記","文件","網站","Web Software","Build website","Nginx","快取","Cache"],"description":"Ubuntu Nginx Cache 建置常用指令","excerpt":"Ubuntu Nginx Cache 建置常用指令","ref":"/docs/web/nginx/cache/","tags":["Ubuntu","筆記","文件","網站","Web Software","Build website","Nginx","快取","Cache"],"title":"Cache"},{"body":"","categories":["Ubuntu","筆記","文件","監控","Monitor"],"description":"Ubuntu 系統監控常用指令","excerpt":"Ubuntu 系統監控常用指令","ref":"/docs/monitor/","tags":["Ubuntu","筆記","文件","監控","Monitor"],"title":"監控"},{"body":"查詢硬碟使用狀況 df -h 查詢資料夾所佔硬碟空間 sudo du -hs {查詢目錄} sudo du -hs /home/web/laravel/* 2.6M\t/home/web/laravel/app 4.0K\t/home/web/laravel/artisan 36K /home/web/laravel/bootstrap 4.0K\t/home/web/laravel/bower.json 4.0K\t/home/web/laravel/composer.json 196K\t/home/web/laravel/composer.lock 124K\t/home/web/laravel/config 132K\t/home/web/laravel/database 4.0K\t/home/web/laravel/package.json 4.0K\t/home/web/laravel/phpunit.xml 7.7G\t/home/web/laravel/public 4.0K\t/home/web/laravel/readme.md 1.6M\t/home/web/laravel/resources 276K\t/home/web/laravel/routes 4.0K\t/home/web/laravel/server.php 827M\t/home/web/laravel/storage 28K /home/web/laravel/tests 64M /home/web/laravel/vendor 4.0K\t/home/web/laravel/webpack.mix.js 列出路徑下檔案空間，使用 MB ls -al --block-size=M 參考資料  Day 15 ubuntu 查詢硬碟使用量df指令 - iT 邦幫忙::一起幫忙解決難題，拯救 IT 人的一天 Day 16 ubuntu 查詢檔案或目錄的磁碟使用空間du指令 - iT 邦幫忙::一起幫忙解決難題，拯救 IT 人的一天 Linux 檢查硬碟使用量 df 指令教學與指令稿範例 - G. T. Wang  ","categories":["Ubuntu","筆記","文件","系統","硬碟空間","Hard Drive"],"description":"","excerpt":"查詢硬碟使用狀況 df -h 查詢資料夾所佔硬碟空間 sudo du -hs {查詢目錄} sudo du -hs /home/web/laravel/* 2.6M\t/home/web/laravel/app 4.0K\t/home/web/laravel/artisan 36K /home/web/laravel/bootstrap 4.0K\t/home/web/laravel/bower.json 4.0K\t/home/web/laravel/composer.json 196K\t/home/web/laravel/composer.lock 124K …","ref":"/docs/system/hard-drive/","tags":["Ubuntu","筆記","文件","系統","硬碟空間","Hard Drive"],"title":"硬碟空間"},{"body":"PHP FPM 除錯 recv() failed (104: Connection reset by peer) while reading response header from upstream Nginx 錯誤 Log\n在 nginx 發現 php-fpm.sock 的錯誤\n2018/10/24 03:47:05 [error] 1231#1231: *324 recv() failed (104: Connection reset by peer) while reading response header from upstream, client: 172.31.22.62, server: _, request: \"POST /post/article HTTP/1.1\", upstream: \"fastcgi://unix:/run/php/php7.1-fpm.sock:\", host: \"kejyun.com\" PHP 錯誤 log\n在 php fpm error log 發現 pm.max_children setting (5), consider raising it 的錯誤\nsudo vim /var/log/php7.1-fpm.log [24-Oct-2018 01:09:33] WARNING: [pool www] server reached pm.max_children setting (5), consider raising it [24-Oct-2018 07:20:16] WARNING: [pool www] server reached pm.max_children setting (5), consider raising it [24-Oct-2018 07:43:58] WARNING: [pool www] server reached pm.max_children setting (5), consider raising it [24-Oct-2018 08:27:52] WARNING: [pool www] server reached pm.max_children setting (5), consider raising it 提高請求中斷時間（request_terminate_timeout）\nsudo vim /etc/php/7.1/fpm/pool.d/www.conf request_terminate_timeout = 300 提高 Server fastcgi read timeout\nvim /etc/nginx/sites-available/kejyun.com location ~ \\.php$ { fastcgi_connect_timeout 300; fastcgi_send_timeout 300; fastcgi_read_timeout 300; } 提高 php fpm max_children\n請參考 PHP FPM Max Children 這篇文章，根據自己主機的狀況需求去提高可以使用的 php-fpm children 數量，提高存取效率\n使用 sudo add-apt-repository ppa:ondrej/php 發生錯誤 $ sudo add-apt-repository ppa:ondrej/php Co-installable PHP versions: PHP 5.6, PHP 7.x and most requested extensions are included. Only Supported Versions of PHP (http://php.net/supported-versions.php) for Supported Ubuntu Releases (https://wiki.ubuntu.com/Releases) are provided. Don't ask for end-of-life PHP versions or Ubuntu release, they won't be provided. Debian oldstable and stable packages are provided as well: https://deb.sury.org/#debian-dpa You can get more information about the packages at https://deb.sury.org BUGS\u0026FEATURES: This PPA now has a issue tracker: https://deb.sury.org/#bug-reporting CAVEATS: 1. If you are using php-gearman, you need to add ppa:ondrej/pkg-gearman 2. If you are using apache2, you are advised to add ppa:ondrej/apache2 3. If you are using nginx, you are advise to add ppa:ondrej/nginx-mainline or ppa:ondrej/nginx PLEASE READ: If you like my work and want to give me a little motivation, please consider donating regularly: https://donate.sury.org/ WARNING: add-apt-repository is broken with non-UTF-8 locales, see https://github.com/oerdnj/deb.sury.org/issues/56 for workaround: # LC_ALL=C.UTF-8 add-apt-repository ppa:ondrej/php More info: https://launchpad.net/~ondrej/+archive/ubuntu/php Press [ENTER] to continue or ctrl-c to cancel adding it gpg: keyring `/tmp/tmpw76p12wa/secring.gpg' created gpg: keyring `/tmp/tmpw76p12wa/pubring.gpg' created gpg: requesting key E5267A6C from hkp server keyserver.ubuntu.com gpg: /tmp/tmpw76p12wa/trustdb.gpg: trustdb created gpg: key E5267A6C: public key \"Launchpad PPA for Ond\\xc5\\x99ej Sur�\" imported gpg: Total number processed: 1 gpg: imported: 1 (RSA: 1) Exception in thread Thread-1: Traceback (most recent call last): File \"/usr/lib/python3.4/threading.py\", line 920, in _bootstrap_inner self.run() File \"/usr/lib/python3.4/threading.py\", line 868, in run self._target(*self._args, **self._kwargs) File \"/usr/lib/python3/dist-packages/softwareproperties/SoftwareProperties.py\", line 687, in addkey_func func(**kwargs) File \"/usr/lib/python3/dist-packages/softwareproperties/ppa.py\", line 370, in add_key return apsk.add_ppa_signing_key() File \"/usr/lib/python3/dist-packages/softwareproperties/ppa.py\", line 261, in add_ppa_signing_key tmp_export_keyring, signing_key_fingerprint, tmp_keyring_dir): File \"/usr/lib/python3/dist-packages/softwareproperties/ppa.py\", line 210, in _verify_fingerprint got_fingerprints = self._get_fingerprints(keyring, keyring_dir) File \"/usr/lib/python3/dist-packages/softwareproperties/ppa.py\", line 202, in _get_fingerprints output = subprocess.check_output(cmd, universal_newlines=True) File \"/usr/lib/python3.4/subprocess.py\", line 609, in check_output output, unused_err = process.communicate(inputdata, timeout=timeout) File \"/usr/lib/python3.4/subprocess.py\", line 947, in communicate stdout = _eintr_retry_call(self.stdout.read) File \"/usr/lib/python3.4/subprocess.py\", line 491, in _eintr_retry_call return func(*args) File \"/usr/lib/python3.4/encodings/ascii.py\", line 26, in decode return codecs.ascii_decode(input, self.errors)[0] UnicodeDecodeError: 'ascii' codec can't decode byte 0xc5 in position 92: ordinal not in range(128) $ 由於當系統不是 UTF-8 的 locales，會發生這個錯誤，只要在指令前方加入 locales 指令即可\n$ sudo LC_ALL=C.UTF-8 add-apt-repository ppa:ondrej/php sudo apt-get update 時出現 Failed to fetch http://ppa.launchpad.net/ondrej/php5-5.6/ubuntu/dists/trusty/main/binary-amd64/Packages 403 Forbidden 訊息 $ sudo apt-get update W: Failed to fetch http://ppa.launchpad.net/ondrej/php5-5.6/ubuntu/dists/trusty/main/binary-amd64/Packages 403 Forbidden E: Some index files failed to download. They have been ignored, or old ones used instead. 由於 php 資源庫的位置已更新，可以移除資源庫清單資料即可\nsudo rm /etc/apt/sources.list.d/ondrej-php5-5_6-trusty.list sudo add-apt-repository -y ppa:ondrej/php sudo apt-get -y update 參考資料  Increase PHP script execution time with Nginx php-fpm超時時間設置request_terminate_timeout分析 - 掃文資訊 php-fpm中的request_terminate_timeout最好不要设置 解决 recv() failed (104: Connection reset by peer) while reading response header from upstream 经验之谈：nginx php 502 bad gateway 解决方法_壹聚教程网 解决 添加 ppa:ondrej/php 时出现无法解码的报错 - 墨客 ubuntu - apt-get install php repository 403 « tedshd’s DevNote How To Upgrade to PHP 7 on Ubuntu 14.04 | DigitalOcean  ","categories":["Ubuntu","筆記","文件","網站","Web Software","Build website","PHP","除錯","Debug"],"description":"Ubuntu PHP 除錯 Debug 常用指令","excerpt":"Ubuntu PHP 除錯 Debug 常用指令","ref":"/docs/web/php/debug/","tags":["Ubuntu","筆記","文件","網站","Web Software","Build website","PHP","除錯","Debug"],"title":"除錯"},{"body":"Virtual Host 設定 在 server_name 設定不同的網址名稱，可以在同一台主機將請求導向到不同的程序去處理\nserver { listen 80; server_name kejyun.com; return 301 https://$server_name$request_uri; } server { listen 443 ssl; server_name kejyun.com; root \"/home/kejyun/tnl/web/tnl_frontend_laravel/public\"; charset utf-8; index index.htm index.html index.php; error_page 404 /404.html; # add_header X-Frame-Options SAMEORIGIN; #add_header X-W \"if you are reading this, come talk to us. job(at)thenewslens.com\"; location / { try_files $uri $uri/ /index.php?$query_string; } location ~ [^/]\\.php(/|$) { fastcgi_split_path_info ^(.+?\\.php)(/.*)$; if (!-f $document_root$fastcgi_script_name) { return 404; } fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name; fastcgi_pass unix:/run/php/php7.1-fpm.sock; fastcgi_index index.php; include fastcgi_params; } location ~* \\.(jpg|jpeg|gif|png|css|js|ico|xml)$ { access_log off; log_not_found off; } error_log /var/log/nginx/kejyun.com-error.log error; access_log /var/log/nginx/kejyun.com.access.log; ssl_protocols TLSv1 TLSv1.1 TLSv1.2; ssl_prefer_server_ciphers on; ssl_dhparam /etc/ssl/certs/dhparam.pem; ssl_ciphers 'ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:DHE-DSS-AES128-GCM -SHA256:kEDH+AESGCM:ECDHE-RSA-AES128-SHA256:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA:ECDHE-ECDSA-AES128-SHA:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES 256-SHA:ECDHE-ECDSA-AES256-SHA:DHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA:DHE-DSS-AES128-SHA256:DHE-RSA-AES256-SHA256:DHE-DSS-AES256-SHA:DHE-RSA-AES256-SHA:AES128-GCM-SHA256:AES25 6-GCM-SHA384:AES128-SHA256:AES256-SHA256:AES128-SHA:AES256-SHA:AES:CAMELLIA:DES-CBC3-SHA:!aNULL:!eNULL:!EXPORT:!DES:!RC4:!MD5:!PSK:!aECDH:!EDH-DSS-DES-CBC3-SHA:!EDH-RSA-DES-CBC3 -SHA:!KRB5-DES-CBC3-SHA'; ssl_session_timeout 1d; ssl_session_cache shared:SSL:50m; ssl_certificate /etc/letsencrypt/live/kejyun.com/fullchain.pem; # managed by Certbot ssl_certificate_key /etc/letsencrypt/live/kejyun.com/privkey.pem; # managed by Certbot } ","categories":["Ubuntu","筆記","文件","網站","Web Software","Build website","Nginx","虛擬主機","Virtual Host"],"description":"Ubuntu Nginx Virtual Host 建置常用指令","excerpt":"Ubuntu Nginx Virtual Host 建置常用指令","ref":"/docs/web/nginx/virtual-host/","tags":["Ubuntu","筆記","文件","網站","Web Software","Build website","Nginx","虛擬主機","Virtual Host"],"title":"Virtual Host"},{"body":"進入排程設定檔案 sudo crontab -l sudo crontab -e 排程格式 * * * * * /bin/execute/this/script.sh * 位置代表意義\n   位置（由左至右） 說明 範圍     1 分鐘 0-59   2 小時 0-23   3 每月第幾天 1-31   4 第幾個月 1-12   5 星期幾 0-6，0: 禮拜日     * 代表每次條件都符合\n 特殊字元 @reboot 開機後執行一次 @yearly 一年執行一次 \"0 0 1 1 *\" @annually (與 @yearly 功能相同) @monthly 一個月執行一次 \"0 0 1 * *\" @weekly 一週執行一次 \"0 0 * * 0\" @daily 一天執行一次 \"0 0 * * *\" @midnight (與 @daily 功能相同) @hourly 一小時執行一次 \"0 * * * *\" 將執行的結果丟到垃圾桶不顯示 */10 * * * * /bin/execute/this/script.sh \u003e /dev/null 2\u003e\u00261 測試 crontab 直接執行 crontab 指令就可以知道 crontab 是否有設定正確\ncrontab path/to/crontab/file 如果有錯誤的狀況發生就會顯示相關的錯誤訊息\n\"/etc/crontab\":165: bad day-of-month errors in crontab file, can\\'t install. 參考資料  Schedule Tasks on Linux Using Crontab | kvz.io Crontab.guru - The cron schedule expression editor cron - Is there a way to validate /etc/crontab’s format? - Server Fault  ","categories":["Ubuntu","筆記","文件","系統","排程","Crontab","schedule"],"description":"","excerpt":"進入排程設定檔案 sudo crontab -l sudo crontab -e 排程格式 * * * * * /bin/execute/this/script.sh * 位置代表意義\n   位置（由左至右） 說明 範圍     1 分鐘 0-59   2 小時 0-23   3 每月第幾天 1-31   4 第幾個月 1-12   5 星期幾 0-6，0: 禮拜日     * 代表每次條件都符合\n 特殊字元 @reboot 開機後執行一次 @yearly 一年執行一次 \"0 0 1 1 *\" @annually (與 @yearly 功能相同) @monthly 一個月執行一次 \"0 0 1 …","ref":"/docs/system/crontab-schedule/","tags":["Ubuntu","筆記","文件","系統","排程","Crontab","schedule"],"title":"排程"},{"body":"參考資料  command line - How to see time stamps in bash history? - Ask Ubuntu Syslog: log all bash history from every user - WebPlay - And let’s play  ","categories":["Ubuntu","筆記","文件","日誌","Log"],"description":"Ubuntu 系統日誌常用指令","excerpt":"Ubuntu 系統日誌常用指令","ref":"/docs/log/","tags":["Ubuntu","筆記","文件","日誌","Log"],"title":"日誌"},{"body":"不顯示 Nginx 版本 http { # 不顯示 Nginx 版本 server_tokens off; } 禁止存取隱藏檔 server { location ~ /\\. { access_log off; log_not_found off; deny all; } } 其他 events { # 使用 epoll 效能較好 use epoll; # 可同時接受多條連線 multi_accept on; } 參考資料  Nginx 與 PHP-FPM 最佳化效能設定教學與技巧 - G. T. Wang  ","categories":["Ubuntu","筆記","文件","網站","Web Software","Build website","Nginx","Security","安全"],"description":"Ubuntu Nginx 安全 Security 建置常用指令","excerpt":"Ubuntu Nginx 安全 Security 建置常用指令","ref":"/docs/web/nginx/security/","tags":["Ubuntu","筆記","文件","網站","Web Software","Build website","Nginx","Security","安全"],"title":"安全"},{"body":"","categories":["Ubuntu","筆記","文件","編輯器","Editor"],"description":"Ubuntu 系統編輯器常用指令","excerpt":"Ubuntu 系統編輯器常用指令","ref":"/docs/editor/","tags":["Ubuntu","筆記","文件","編輯器","Editor"],"title":"編輯器"},{"body":"開機自動執行指定程式 將開機需要執行的指定程式寫入 /etc/rc.local 即可\n#!/bin/sh -e # # rc.local # # This script is executed at the end of each multiuser runlevel. # Make sure that the script will \"exit 0\" on success or any other # value on error. # # In order to enable or disable this script just change the execution # bits. # # By default this script does nothing. # 開機自動啟動 bash /home/ubuntu/scripts/boot.sh \u003e /dev/null 2\u003e\u00261 # 自動部署程式 bash /home/ubuntu/scripts/deploy.sh \u003e /dev/null 2\u003e\u00261 輸入下列指令可以檢查目前這個服務執行的狀態\nsystemctl status rc.local.service $ systemctl status rc.local.service ● rc-local.service - /etc/rc.local Compatibility Loaded: loaded (/lib/systemd/system/rc-local.service; enabled-runtime; vendor preset: enabled) Drop-In: /lib/systemd/system/rc-local.service.d └─debian.conf Active: active (exited) since Wed 2019-09-25 15:52:07 CST; 33min ago Docs: man:systemd-rc-local-generator(8) Process: 793 ExecStart=/etc/rc.local start (code=exited, status=0/SUCCESS) Sep 25 15:54:33 ip-172-31-25-154 rc.local[793]: Deploy Done 使用 crontab 重新開機後自動執行 crontab -e # 開機自動啟動 @reboot bash /home/ubuntu/scripts/boot.sh \u003e /dev/null 2\u003e\u00261 # 自動部署程式 @reboot bash /home/ubuntu/scripts/deploy.sh \u003e /dev/null 2\u003e\u00261 參考資料  boot - Run bash script on startup - Raspberry Pi Stack Exchange Schedule Tasks on Linux Using Crontab | kvz.io  ","categories":["Ubuntu","筆記","文件","系統","開機自動執行","boot auto execute"],"description":"","excerpt":"開機自動執行指定程式 將開機需要執行的指定程式寫入 /etc/rc.local 即可\n#!/bin/sh -e # # rc.local # # This script is executed at the end of each multiuser runlevel. # Make sure that the script will \"exit 0\" on success or any other # value on error. # # In order to enable or disable this script just change the execution # bits. …","ref":"/docs/system/boot-auto-execute/","tags":["Ubuntu","筆記","文件","系統","開機自動執行","boot auto execute"],"title":"開機自動執行"},{"body":"","categories":["Ubuntu","筆記","文件","shell"],"description":"Ubuntu 系統 shell 常用指令","excerpt":"Ubuntu 系統 shell 常用指令","ref":"/docs/shell/","tags":["Ubuntu","筆記","文件","shell"],"title":"shell"},{"body":"error_page Nginx 自訂錯誤頁\nserver { error_page 404 https://kejyun.com/404; # 錯誤頁 } proxy_intercept_errors 若被代理伺服器回傳 400 或大於 400 的狀態碼，啟用設定的 error_page 設定，預設為 off 不啟用\n Determines whether proxied responses with codes greater than or equal to 300 should be passed to a client or be intercepted and redirected to nginx for processing with the error_page directive.\n server { proxy_intercept_errors on; } fastcgi_intercept_errors 若被 FastCGI 伺服器回傳 300 或大於 300 的狀態碼，啟用設定的 error_page 設定，預設為 off 不啟用\n Determines whether FastCGI server responses with codes greater than or equal to 300 should be passed to a client or be intercepted and redirected to nginx for processing with the error_page directive.\n server { proxy_intercept_errors on; } 參考資料  Module ngx_http_proxy_module Module ngx_http_fastcgi_module Nginx代理功能与负载均衡详解 - 张龙豪 - 博客园  ","categories":["Ubuntu","筆記","文件","網站","Web Software","Build website","Nginx","Parameter","參數"],"description":"Ubuntu Nginx 參數常用指令","excerpt":"Ubuntu Nginx 參數常用指令","ref":"/docs/web/nginx/parameter/","tags":["Ubuntu","筆記","文件","網站","Web Software","Build website","Nginx","Parameter","參數"],"title":"參數"},{"body":"Nginx Multiple Root 同網站不同 Root 在做網站改版的時候，可能因為專案太大而無法一次全部改版，所以希望能夠針對部分的 頁面或API 進行改版，然後慢慢的全部迭代改版完成，為了做到這樣的效果，可以透過 Nginx 指定不同的網址路徑，去執行不同的程式，這邊以 PHP Laravel Framework 為例。\n由於舊專案是 Laravel 4.2 但新專案是 Laravel 5.5，程式改版過程中將改版完成的網址路徑導向至 Laravel 5.5，但尚未完成改版的項目則還是繼續導向至 Laravel 4.2，由 nginx 判斷請求路徑，去控制判斷要執行哪一部分的程式。\nserver { listen 80; server_name _; # 預設使用 Laravel 5.5 root \"/home/deploy/laravel55/public\"; charset utf-8; index index.htm index.html index.php; error_page 404 /404.html; if ($request_uri ~* \"^(.*/)index\\.php/*(.*)\") { return 301 $1$2; } location / { try_files $uri $uri/ /index.php?$args; } location /elb-status { access_log off; return 200; } access_log /var/log/nginx/web-access.log cloudflare; error_log /var/log/nginx/web-error.log error; location = /robots.txt { access_log off; log_not_found off; } location = /favicon.ico { access_log off; log_not_found off; } location ~ ^/assets/ { try_files $uri $uri/ /index.php?$args; expires max; add_header Cache-Control public; access_log off; } location ~ ^/(api|old-uri-path1|old-uri-path2)(.*)$ { # 指定舊網址，變更網站路徑為 Laravel 4 root \"/home/deploy/laravel4/current/public\"; # Rewrite $uri=/api/v1/xyz back to just $uri=/xyz rewrite ^(.*)$ /$1 break; # Try to send static file at $url or $uri/ # Else try /index.php (which will hit location ~\\.php$ below) try_files $uri $uri/ /index.php?$args; } location ~ [^/]\\.php(/|$) { set $newurl $request_uri; # 預設使用 php 7.1 fpm 執行 fastcgi_pass unix:/run/php/php7.1-fpm.sock; if ($newurl ~ ^/(api|old-uri-path1|old-uri-path2)(.*)$) { # 變更網站路徑為 Laravel 4.2 root \"/home/deploy/laravel4/current/public\"; # 舊網址使用 php 7.0 fpm 執行 fastcgi_pass unix:/run/php/php7.0-fpm.sock; } fastcgi_split_path_info ^(.+\\.php)(/.+)$; fastcgi_index index.php; include fastcgi_params; fastcgi_param REQUEST_URI $newurl; fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name; fastcgi_intercept_errors off; fastcgi_buffer_size 16k; fastcgi_buffers 4 16k; } proxy_intercept_errors on; fastcgi_intercept_errors on; # gzip gzip on; gzip_min_length 1000; gzip_types *; gzip_comp_level 3; gzip_proxied any; gzip_buffers 16 8k; gzip_http_version 1.1; } 預設是執行 Laravel 5.5，而設定的例外路徑則是存取 Laravel 4.2\n參考資料  Nginx config for multiple laravel sites based on /api/v1 url paths Setting up Django and your web server with uWSGI and nginx — uWSGI 2.0 documentation 教學課程：使用以路徑為基礎的路由與 Application Load Balancer 搭配使用 - Elastic Load Balancing node.js - nginx + nodejs + php - Stack Overflow debian - nginx server config with multiple locations does not work - Unix \u0026 Linux Stack Exchange Nginx 的 try_files 指令使用实例 - 运维之美 Nginx的try_files参数保证能懂的讲解-10536390-51CTO博客 Nginx - Changing the server root make location root not working - Stack Overflow php - nginx configuration with multiple location blocks - Stack Overflow Understanding Nginx Server and Location Block Selection Algorithms | DigitalOcean How to proxy web apps using nginx? · GitHub Nginx multiple server setting  ","categories":["Ubuntu","筆記","文件","網站","Web Software","Build website","Nginx","同網站不同 root","Multiple document root on same site"],"description":"Ubuntu Nginx 同網站不同 root 常用指令","excerpt":"Ubuntu Nginx 同網站不同 root 常用指令","ref":"/docs/web/nginx/multiple-root/","tags":["Ubuntu","筆記","文件","網站","Web Software","Build website","Nginx","同網站不同 root","Multiple document root on same site"],"title":"同網站不同 root"},{"body":"回傳參數 location ~ \\.php$ { return 200 $args; add_header Content-Type text/plain; return 200 $uri; add_header Content-Type text/plain; return 200 $document_root; add_header Content-Type text/plain; return 200 $request_uri; add_header Content-Type text/plain; }  $args：get 參數（e.g. ?page=2） $uri：網址路徑（e.g. /tag/laravel） $document_root：網頁路徑（e.g. /var/web/laravel/public） $request_uri：完整請求 URI（/tag/laravel?page=2）  測試 site-enabled 設定 nginx -t 413 Request entity too large Nginx 預設檔案上傳大小為 100M，可以修改設定值提高上傳檔案大小\nsudo vim /etc/nginx/nginx.conf 打開 nginx.conf 後，在 http 設定值中加入 client_max_body_size 並修改上傳檔案大小\n 若沒有此設定值可自行加入\n http { client_max_body_size 100M; } could not build server_names_hash, you should increase server_names_hash_bucket_size: 64 在新增 Nginx 主機時，發現網址名稱有過長的問題\n$ systemctl status nginx.service ● nginx.service - A high performance web server and a reverse proxy server Loaded: loaded (/lib/systemd/system/nginx.service; enabled; vendor preset: enabled) Active: failed (Result: exit-code) since Thu 2019-03-07 08:28:21 UTC; 7s ago Process: 9595 ExecStop=/sbin/start-stop-daemon --quiet --stop --retry QUIT/5 --pidfile /run/nginx.pid (code=exited, status=0/SUCCESS) Process: 9827 ExecStartPre=/usr/sbin/nginx -t -q -g daemon on; master_process on; (code=exited, status=1/FAILURE) Main PID: 31527 (code=exited, status=0/SUCCESS) Mar 07 08:28:21 tnl-dev systemd[1]: Starting A high performance web server and a reverse proxy server... Mar 07 08:28:21 tnl-dev nginx[9827]: nginx: [emerg] could not build server_names_hash, you should increase server_names_hash_bucket_size: 64 Mar 07 08:28:21 tnl-dev nginx[9827]: nginx: configuration file /etc/nginx/nginx.conf test failed Mar 07 08:28:21 tnl-dev systemd[1]: nginx.service: Control process exited, code=exited status=1 Mar 07 08:28:21 tnl-dev systemd[1]: Failed to start A high performance web server and a reverse proxy server. Mar 07 08:28:21 tnl-dev systemd[1]: nginx.service: Unit entered failed state. Mar 07 08:28:21 tnl-dev systemd[1]: nginx.service: Failed with result 'exit-code'. 此時可以到 /etc/nginx/nginx.conf 將 server_names_hash_max_size 設定更高的數值\nserver_names_hash_max_size 512; server_names_hash_max_size 1024; 設定完後重新啟動 Nginx 就可以正常啟動了\n參考資料  解決 Nginx 錯誤: 413 Request entity too large nginx配置server_names_hash_max_size放在什么地方？ - SegmentFault 思否  ","categories":["Ubuntu","筆記","文件","網站","Web Software","Build website","Nginx","Debug","除錯"],"description":"Ubuntu Nginx 除錯 Debug 常用指令","excerpt":"Ubuntu Nginx 除錯 Debug 常用指令","ref":"/docs/web/nginx/debug/","tags":["Ubuntu","筆記","文件","網站","Web Software","Build website","Nginx","Debug","除錯"],"title":"除錯"},{"body":"","categories":["Ubuntu","筆記","文件","常用網路指令","網路","Network","ssh","常見問題"],"description":"Ubuntu 系統網路 ssh 指令常見問題","excerpt":"Ubuntu 系統網路 ssh 指令常見問題","ref":"/docs/network/ssh/question/","tags":["Ubuntu","筆記","文件","常用網路指令","網路","Network","ssh","常見問題"],"title":"常見問題"},{"body":"  #td-cover-block-0 { background-image: url(/hugo-background-1_hu8bca9a2df10ebf7f54e0ba5f72b967f8_6746_960x540_fill_catmullrom_bottom_2.png); } @media only screen and (min-width: 1200px) { #td-cover-block-0 { background-image: url(/hugo-background-1_hu8bca9a2df10ebf7f54e0ba5f72b967f8_6746_1920x1080_fill_catmullrom_bottom_2.png); } }  Ubuntu for Newbie Ubuntu 菜雞踩雷學習筆記        記錄學習 Ubuntu 遇到各種不同的系統狀況處理紀錄\n   ","categories":"","description":"","excerpt":"  #td-cover-block-0 { background-image: url(/hugo-background-1_hu8bca9a2df10ebf7f54e0ba5f72b967f8_6746_960x540_fill_catmullrom_bottom_2.png); } @media only screen and (min-width: 1200px) { #td-cover-block-0 { background-image: …","ref":"/","tags":"","title":"Ubuntu for newbie"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/","tags":"","title":"Categories"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/network/","tags":"","title":"Network"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/network/","tags":"","title":"Network"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/port-forward/","tags":"","title":"port forward"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/port-forward/","tags":"","title":"port forward"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/port-%E8%BD%89%E7%99%BC/","tags":"","title":"port 轉發"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/port-%E8%BD%89%E7%99%BC/","tags":"","title":"port 轉發"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/ssh/","tags":"","title":"ssh"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/ssh/","tags":"","title":"ssh"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/ssh-tunnel/","tags":"","title":"ssh tunnel"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/ssh-tunnel/","tags":"","title":"ssh tunnel"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/","tags":"","title":"Tags"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/ubuntu/","tags":"","title":"Ubuntu"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/ubuntu/","tags":"","title":"Ubuntu"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/%E5%B8%B8%E7%94%A8%E7%B6%B2%E8%B7%AF%E6%8C%87%E4%BB%A4/","tags":"","title":"常用網路指令"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/%E5%B8%B8%E7%94%A8%E7%B6%B2%E8%B7%AF%E6%8C%87%E4%BB%A4/","tags":"","title":"常用網路指令"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/%E6%96%87%E4%BB%B6/","tags":"","title":"文件"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/%E6%96%87%E4%BB%B6/","tags":"","title":"文件"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/%E7%AD%86%E8%A8%98/","tags":"","title":"筆記"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/%E7%AD%86%E8%A8%98/","tags":"","title":"筆記"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/%E7%B6%B2%E8%B7%AF/","tags":"","title":"網路"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/%E7%B6%B2%E8%B7%AF/","tags":"","title":"網路"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/config/","tags":"","title":"config"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/config/","tags":"","title":"config"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/%E5%9F%B7%E8%A1%8C%E9%81%A0%E7%AB%AF%E4%B8%BB%E6%A9%9F%E6%8C%87%E4%BB%A4/","tags":"","title":"執行遠端主機指令"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/%E5%9F%B7%E8%A1%8C%E9%81%A0%E7%AB%AF%E4%B8%BB%E6%A9%9F%E6%8C%87%E4%BB%A4/","tags":"","title":"執行遠端主機指令"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/%E5%BB%BA%E7%AB%8B%E9%87%91%E9%91%B0/","tags":"","title":"建立金鑰"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/%E5%BB%BA%E7%AB%8B%E9%87%91%E9%91%B0/","tags":"","title":"建立金鑰"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/%E7%94%A2%E7%94%9F%E7%9A%84%E9%87%91%E9%91%B0%E7%84%A1%E6%B3%95%E4%BD%BF%E7%94%A8/","tags":"","title":"產生的金鑰無法使用"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/%E7%94%A2%E7%94%9F%E7%9A%84%E9%87%91%E9%91%B0%E7%84%A1%E6%B3%95%E4%BD%BF%E7%94%A8/","tags":"","title":"產生的金鑰無法使用"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/%E8%A4%87%E8%A3%BD%E9%81%A0%E7%AB%AF%E6%AA%94%E6%A1%88scp/","tags":"","title":"複製遠端檔案(scp)"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/%E8%A4%87%E8%A3%BD%E9%81%A0%E7%AB%AF%E6%AA%94%E6%A1%88scp/","tags":"","title":"複製遠端檔案(scp)"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/ip-address/","tags":"","title":"ip address"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/ip-address/","tags":"","title":"ip address"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/ssh-key-to-same-site/","tags":"","title":"ssh key to same site"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/ssh-key-to-same-site/","tags":"","title":"ssh key to same site"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/%E5%B8%B8%E8%A6%8B%E5%95%8F%E9%A1%8C/","tags":"","title":"常見問題"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/%E5%B8%B8%E8%A6%8B%E5%95%8F%E9%A1%8C/","tags":"","title":"常見問題"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/%E6%9F%A5%E8%A9%A2-ip/","tags":"","title":"查詢 ip"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/%E6%9F%A5%E8%A9%A2-ip/","tags":"","title":"查詢 ip"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/2fa/","tags":"","title":"2FA"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/2fa/","tags":"","title":"2FA"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/apache/","tags":"","title":"Apache"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/apache/","tags":"","title":"Apache"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/auth/","tags":"","title":"auth"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/auth/","tags":"","title":"auth"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/boot-auto-execute/","tags":"","title":"boot auto execute"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/boot-auto-execute/","tags":"","title":"boot auto execute"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/build-website/","tags":"","title":"Build website"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/build-website/","tags":"","title":"Build website"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/cache/","tags":"","title":"Cache"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/cache/","tags":"","title":"Cache"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/cert/","tags":"","title":"cert"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/cert/","tags":"","title":"cert"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/common-command/","tags":"","title":"Common Command"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/common-command/","tags":"","title":"Common Command"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/crontab/","tags":"","title":"Crontab"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/crontab/","tags":"","title":"Crontab"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/debug/","tags":"","title":"Debug"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/debug/","tags":"","title":"Debug"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/editor/","tags":"","title":"Editor"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/editor/","tags":"","title":"Editor"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/fastcgi_pass/","tags":"","title":"fastcgi_pass"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/fastcgi_pass/","tags":"","title":"fastcgi_pass"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/function/","tags":"","title":"function"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/function/","tags":"","title":"function"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/grep/","tags":"","title":"grep"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/grep/","tags":"","title":"grep"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/grep-%E6%8C%87%E4%BB%A4/","tags":"","title":"grep 指令"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/grep-%E6%8C%87%E4%BB%A4/","tags":"","title":"grep 指令"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/group/","tags":"","title":"Group"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/group/","tags":"","title":"Group"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/gzip/","tags":"","title":"Gzip"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/gzip/","tags":"","title":"Gzip"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/hard-drive/","tags":"","title":"Hard Drive"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/hard-drive/","tags":"","title":"Hard Drive"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/hostname/","tags":"","title":"hostname"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/hostname/","tags":"","title":"hostname"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/install/","tags":"","title":"Install"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/install/","tags":"","title":"Install"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/install-latest-php-version/","tags":"","title":"Install Latest PHP version"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/install-latest-php-version/","tags":"","title":"Install Latest PHP version"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/language/","tags":"","title":"language"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/language/","tags":"","title":"language"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/lets-encrypt/","tags":"","title":"Let's Encrypt"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/lets-encrypt/","tags":"","title":"Let's Encrypt"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/locale/","tags":"","title":"locale"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/locale/","tags":"","title":"locale"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/log/","tags":"","title":"Log"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/log/","tags":"","title":"Log"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/max_children/","tags":"","title":"max_children"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/max_children/","tags":"","title":"max_children"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/monitor/","tags":"","title":"Monitor"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/monitor/","tags":"","title":"Monitor"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/multiple-document-root-on-same-site/","tags":"","title":"Multiple document root on same site"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/multiple-document-root-on-same-site/","tags":"","title":"Multiple document root on same site"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/mysql/","tags":"","title":"MySQL"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/mysql/","tags":"","title":"MySQL"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/neterr_cert_common_name_invalid/","tags":"","title":"NET::ERR_CERT_COMMON_NAME_INVALID"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/neterr_cert_common_name_invalid/","tags":"","title":"NET::ERR_CERT_COMMON_NAME_INVALID"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/nginx/","tags":"","title":"Nginx"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/nginx/","tags":"","title":"Nginx"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/parameter/","tags":"","title":"Parameter"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/parameter/","tags":"","title":"Parameter"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/php/","tags":"","title":"PHP"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/php/","tags":"","title":"PHP"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/php-fpm/","tags":"","title":"php-fpm"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/php-fpm/","tags":"","title":"php-fpm"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/privilege/","tags":"","title":"Privilege"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/privilege/","tags":"","title":"Privilege"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/rsync/","tags":"","title":"rsync"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/rsync/","tags":"","title":"rsync"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/rsync-%E6%8C%87%E4%BB%A4/","tags":"","title":"rsync 指令"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/rsync-%E6%8C%87%E4%BB%A4/","tags":"","title":"rsync 指令"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/schedule/","tags":"","title":"schedule"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/schedule/","tags":"","title":"schedule"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/security/","tags":"","title":"Security"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/security/","tags":"","title":"Security"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/server_name/","tags":"","title":"server_name"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/server_name/","tags":"","title":"server_name"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/shell/","tags":"","title":"shell"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/shell/","tags":"","title":"shell"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/software/","tags":"","title":"Software"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/software/","tags":"","title":"Software"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/ssl/","tags":"","title":"SSL"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/ssl/","tags":"","title":"SSL"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/sudo-no-password/","tags":"","title":"sudo no password"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/sudo-no-password/","tags":"","title":"sudo no password"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/swap/","tags":"","title":"SWAP"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/swap/","tags":"","title":"SWAP"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/tar/","tags":"","title":"tar"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/tar/","tags":"","title":"tar"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/tar-%E6%8C%87%E4%BB%A4/","tags":"","title":"tar 指令"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/tar-%E6%8C%87%E4%BB%A4/","tags":"","title":"tar 指令"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/two-factor-authentication/","tags":"","title":"Two-Factor Authentication"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/two-factor-authentication/","tags":"","title":"Two-Factor Authentication"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/vim/","tags":"","title":"Vim"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/vim/","tags":"","title":"Vim"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/virtual-host/","tags":"","title":"Virtual Host"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/virtual-host/","tags":"","title":"Virtual Host"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/web-software/","tags":"","title":"Web Software"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/web-software/","tags":"","title":"Web Software"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/website-monitor/","tags":"","title":"Website Monitor"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/website-monitor/","tags":"","title":"Website Monitor"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/%E4%B8%BB%E6%A9%9F%E5%90%8D%E7%A8%B1/","tags":"","title":"主機名稱"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/%E4%B8%BB%E6%A9%9F%E5%90%8D%E7%A8%B1/","tags":"","title":"主機名稱"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/%E5%85%8D%E8%B2%BB%E6%86%91%E8%AD%89/","tags":"","title":"免費憑證"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/%E5%85%8D%E8%B2%BB%E6%86%91%E8%AD%89/","tags":"","title":"免費憑證"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/%E5%85%8D%E8%BC%B8%E5%85%A5%E5%AF%86%E7%A2%BC/","tags":"","title":"免輸入密碼"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/%E5%85%8D%E8%BC%B8%E5%85%A5%E5%AF%86%E7%A2%BC/","tags":"","title":"免輸入密碼"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/%E5%85%A9%E9%9A%8E%E6%AE%B5%E9%A9%97%E8%AD%89/","tags":"","title":"兩階段驗證"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/%E5%85%A9%E9%9A%8E%E6%AE%B5%E9%A9%97%E8%AD%89/","tags":"","title":"兩階段驗證"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/%E5%87%BD%E5%BC%8F/","tags":"","title":"函式"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/%E5%87%BD%E5%BC%8F/","tags":"","title":"函式"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/%E5%8F%83%E6%95%B8/","tags":"","title":"參數"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/%E5%8F%83%E6%95%B8/","tags":"","title":"參數"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/%E5%90%8C%E7%B6%B2%E7%AB%99%E4%B8%8D%E5%90%8C-root/","tags":"","title":"同網站不同 root"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/%E5%90%8C%E7%B6%B2%E7%AB%99%E4%B8%8D%E5%90%8C-root/","tags":"","title":"同網站不同 root"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/%E5%A3%93%E7%B8%AE/","tags":"","title":"壓縮"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/%E5%A3%93%E7%B8%AE/","tags":"","title":"壓縮"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/%E5%AE%89%E5%85%A8/","tags":"","title":"安全"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/%E5%AE%89%E5%85%A8/","tags":"","title":"安全"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/%E5%AE%89%E8%A3%9D%E6%9C%80%E6%96%B0-php/","tags":"","title":"安裝最新 PHP"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/%E5%AE%89%E8%A3%9D%E6%9C%80%E6%96%B0-php/","tags":"","title":"安裝最新 PHP"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/%E5%B8%B8%E7%94%A8%E6%8C%87%E4%BB%A4/","tags":"","title":"常用指令"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/%E5%B8%B8%E7%94%A8%E6%8C%87%E4%BB%A4/","tags":"","title":"常用指令"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/%E5%BF%AB%E5%8F%96/","tags":"","title":"快取"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/%E5%BF%AB%E5%8F%96/","tags":"","title":"快取"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/%E6%86%91%E8%AD%89/","tags":"","title":"憑證"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/%E6%86%91%E8%AD%89/","tags":"","title":"憑證"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/%E6%8E%92%E7%A8%8B/","tags":"","title":"排程"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/%E6%8E%92%E7%A8%8B/","tags":"","title":"排程"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/%E6%97%A5%E8%AA%8C/","tags":"","title":"日誌"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/%E6%97%A5%E8%AA%8C/","tags":"","title":"日誌"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/%E6%99%82%E9%96%93/","tags":"","title":"時間"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/%E6%99%82%E9%96%93/","tags":"","title":"時間"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/%E6%9B%B4%E6%96%B0%E6%86%91%E8%AD%89/","tags":"","title":"更新憑證"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/%E6%9B%B4%E6%96%B0%E6%86%91%E8%AD%89/","tags":"","title":"更新憑證"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/%E6%AC%8A%E9%99%90/","tags":"","title":"權限"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/%E6%AC%8A%E9%99%90/","tags":"","title":"權限"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/%E7%9B%A3%E6%8E%A7/","tags":"","title":"監控"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/%E7%9B%A3%E6%8E%A7/","tags":"","title":"監控"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/%E7%A1%AC%E7%A2%9F%E7%A9%BA%E9%96%93/","tags":"","title":"硬碟空間"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/%E7%A1%AC%E7%A2%9F%E7%A9%BA%E9%96%93/","tags":"","title":"硬碟空間"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/%E7%B3%BB%E7%B5%B1/","tags":"","title":"系統"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/%E7%B3%BB%E7%B5%B1/","tags":"","title":"系統"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/%E7%B6%B2%E7%AB%99/","tags":"","title":"網站"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/%E7%B6%B2%E7%AB%99/","tags":"","title":"網站"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/%E7%B6%B2%E7%AB%99%E7%9B%A3%E6%8E%A7/","tags":"","title":"網站監控"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/%E7%B6%B2%E7%AB%99%E7%9B%A3%E6%8E%A7/","tags":"","title":"網站監控"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/%E7%B7%A8%E8%BC%AF%E5%99%A8/","tags":"","title":"編輯器"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/%E7%B7%A8%E8%BC%AF%E5%99%A8/","tags":"","title":"編輯器"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/%E7%BE%A4%E7%B5%84/","tags":"","title":"群組"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/%E7%BE%A4%E7%B5%84/","tags":"","title":"群組"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/%E8%99%9B%E6%93%AC%E4%B8%BB%E6%A9%9F/","tags":"","title":"虛擬主機"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/%E8%99%9B%E6%93%AC%E4%B8%BB%E6%A9%9F/","tags":"","title":"虛擬主機"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/%E8%99%9B%E6%93%AC%E8%A8%98%E6%86%B6%E9%AB%94/","tags":"","title":"虛擬記憶體"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/%E8%99%9B%E6%93%AC%E8%A8%98%E6%86%B6%E9%AB%94/","tags":"","title":"虛擬記憶體"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/%E8%AA%8D%E8%AD%89/","tags":"","title":"認證"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/%E8%AA%8D%E8%AD%89/","tags":"","title":"認證"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/%E8%AA%9E%E7%B3%BB/","tags":"","title":"語系"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/%E8%AA%9E%E7%B3%BB/","tags":"","title":"語系"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/%E8%BB%9F%E9%AB%94/","tags":"","title":"軟體"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/%E8%BB%9F%E9%AB%94/","tags":"","title":"軟體"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/%E8%BC%94%E5%8A%A9/","tags":"","title":"輔助"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/%E8%BC%94%E5%8A%A9/","tags":"","title":"輔助"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/%E9%96%8B%E6%A9%9F%E8%87%AA%E5%8B%95%E5%9F%B7%E8%A1%8C/","tags":"","title":"開機自動執行"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/%E9%96%8B%E6%A9%9F%E8%87%AA%E5%8B%95%E5%9F%B7%E8%A1%8C/","tags":"","title":"開機自動執行"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/%E9%99%A4%E9%8C%AF/","tags":"","title":"除錯"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/%E9%99%A4%E9%8C%AF/","tags":"","title":"除錯"}]